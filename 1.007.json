{"ExportedSolution":{"SolutionID":"1.007","Description":"1.007_Monthly_revision","Status":"Created","CreatedTime":"2025-04-02T15:09:32.931843+08:00","ExportedTime":"0001-01-01T06:55:25+06:55","LastUpdated":"0001-01-01T06:55:25+06:55","CreatedUser":"api_user","UpdatedUser":"","ExportedUser":"","ExportComponents":[{"SolutionID":"1.007","ComponentType":"BusinessObject","ComponentID":"cancelInvoice"},{"SolutionID":"1.007","ComponentType":"BusinessObject","ComponentID":"print_options"},{"SolutionID":"1.007","ComponentType":"Dataset","ComponentID":"invoice_data"},{"SolutionID":"1.007","ComponentType":"Topic","ComponentID":"einv_header"},{"SolutionID":"1.007","ComponentType":"Topic","ComponentID":"einv_lines"},{"SolutionID":"1.007","ComponentType":"Topic","ComponentID":"inv_interim_excl"}]},"Topics":[{"Topic":{"Name":"einv_header","Description":"E-Invoice Header","Keys":["e_inv_no"],"SendAlertOnFail":true,"DistributionList":[],"HotTopic":true,"FieldDefs":[{"FieldName":"e_inv_no","Description":"E-Invoice Number","Sequence":1,"DataType":"String","Length":50,"IsKey":true,"IndexSequence":1,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"comp","Description":"Financial Company","Sequence":2,"DataType":"Integer","Length":4,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tran","Description":"Finance Type","Sequence":3,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"idoc","Description":"Invoice Number","Sequence":4,"DataType":"Integer","Length":8,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"doct","Description":"Invoice Type","Sequence":5,"DataType":"String","Length":2,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ccur","Description":"Invoice Currency Code","Sequence":6,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"paym","Description":"Payment Mode","Sequence":7,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"cvat","Description":"Tax Type","Sequence":8,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sctg","Description":"Sales Category","Sequence":9,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"sales_catg","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"dataset","Description":"Dataset","Sequence":10,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"line_cnt","Description":"Line Count","Sequence":11,"DataType":"Integer","Length":4,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"s_line_cnt","Description":"Source Line Count","Sequence":12,"DataType":"Integer","Length":4,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_name","Description":"Supplier Name","Sequence":13,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_cont_num","Description":"Supplier Contact Number","Sequence":14,"DataType":"String","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_email","Description":"Supplier Mail","Sequence":15,"DataType":"String","Length":320,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_sst_reg","Description":"Supplier SST Registration","Sequence":16,"DataType":"String","Length":35,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_ttx_no","Description":"Supplier Tourism Tax Number","Sequence":17,"DataType":"String","Length":17,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_tin","Description":"Supplier TIN","Sequence":18,"DataType":"String","Length":14,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_reg_brn","Description":"Supplier Registration Number","Sequence":19,"DataType":"String","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_reg_nric","Description":"Supplier NRIC","Sequence":20,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_reg_passport","Description":"Supplier Passport Number","Sequence":21,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_reg_army","Description":"Supplier Army Identification","Sequence":22,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_badsca","Description":"Supplier Business Activity","Sequence":23,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_bank_acc","Description":"Supplier Bank Account Number","Sequence":24,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_msic","Description":"Supplier MSIC Code","Sequence":25,"DataType":"String","Length":5,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_adrs","Description":"Supplier Address Code","Sequence":26,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_city","Description":"Supplier City","Sequence":27,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_postal_zone","Description":"Supplier Postal Code","Sequence":28,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_adrs_line0","Description":"Supplier Address Line 0","Sequence":29,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_adrs_line1","Description":"Supplier Address Line 1","Sequence":30,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_adrs_line2","Description":"Supplier Address Line 2","Sequence":31,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_country","Description":"Supplier Country Code","Sequence":32,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"ccty","RefersTo":"country"},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_cste","Description":"Supplier State Code","Sequence":33,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"code","RefersTo":"state_codes"},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"inv_bp","Description":"Buyer Code","Sequence":34,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_name","Description":"Buyer Name","Sequence":35,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_cont_num","Description":"Buyer Contact Number","Sequence":36,"DataType":"String","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_email","Description":"Buyer Mail","Sequence":37,"DataType":"String","Length":320,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_sst_reg","Description":"Buyer SST Registration","Sequence":38,"DataType":"String","Length":35,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_tin","Description":"Buyer TIN","Sequence":39,"DataType":"String","Length":17,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_reg_brn","Description":"Buyer Registration Number","Sequence":40,"DataType":"String","Length":14,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_reg_nric","Description":"Buyer NRIC","Sequence":41,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_reg_passport","Description":"Buyer Passport","Sequence":42,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_reg_army","Description":"Buyer Army","Sequence":43,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_adrs","Description":"Buyer Address","Sequence":44,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_city","Description":"Buyer City","Sequence":45,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_postal_zone","Description":"Buyer Postal Code","Sequence":46,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_adrs_line0","Description":"Buyer Address Line 0","Sequence":47,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_adrs_line1","Description":"Buyer Address Line 1","Sequence":48,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_adrs_line2","Description":"Buyer Address Line 2","Sequence":49,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_country","Description":"Buyer Country Code","Sequence":50,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"ccty","RefersTo":"country"},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_cste","Description":"Buyer State Code","Sequence":51,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"code","RefersTo":"state_codes"},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"dtrm","Description":"Incoterms","Sequence":52,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_bp","Description":"Shipper Code","Sequence":53,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_name","Description":"Shipper Name","Sequence":54,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_tin","Description":"Shipper TIN","Sequence":55,"DataType":"String","Length":14,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_reg_brn","Description":"Shipper Registration Number","Sequence":56,"DataType":"String","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_reg_nric","Description":"Shipper NRIC","Sequence":57,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_reg_passport","Description":"Shipper Passport","Sequence":58,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_reg_army","Description":"Shipper Army","Sequence":59,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_adrs","Description":"Shipper Address Code","Sequence":60,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_city","Description":"Shipper City","Sequence":61,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_postal_zone","Description":"Shipper Postal Code","Sequence":62,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_adrs_line0","Description":"Shipper Address Line 0","Sequence":63,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_adrs_line1","Description":"Shipper Address Line 1","Sequence":64,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_adrs_line2","Description":"Shipper Address Line 2","Sequence":65,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_country","Description":"Shipper Country Code","Sequence":66,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"ccty","RefersTo":"country"},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_cste","Description":"Shipper State Code","Sequence":67,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"code","RefersTo":"state_codes"},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"frm1","Description":"Reference No of Customs form No 1, 9, etc","Sequence":68,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"frm2","Description":"Reference Number of Customs Form No.2","Sequence":69,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"rate","Description":"Currency Exchange Rate","Sequence":70,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tote","Description":"Total Excluding Tax","Sequence":71,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"toti","Description":"Total Including Tax","Sequence":72,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tott","Description":"Total Tax Amount","Sequence":73,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pamt","Description":"PrePayment Amount","Sequence":74,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pydt","Description":"PrePayment Date","Sequence":75,"DataType":"Date","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pytm","Description":"PrePayment Time","Sequence":76,"DataType":"DateTime","Length":25,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pref","Description":"PrePayment Reference Number","Sequence":77,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tpat","Description":"Total Payable Amount","Sequence":78,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tnat","Description":"Total Net Amount","Sequence":79,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tdis","Description":"Total Discount Value","Sequence":80,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tfee","Description":"Total Fee / Charge Amount","Sequence":81,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ramt","Description":"Rounding Amount","Sequence":82,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ttax","Description":"Total Taxable Amount Per Tax Type","Sequence":83,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ttat","Description":"Total Tax Amount Per Tax Type","Sequence":84,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"adis","Description":"Invoice Additional Discount Amount","Sequence":85,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"adis_reason","Description":"Invoice Additional Discount Amount Reason","Sequence":86,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"afee","Description":"Invoice Additional Fee Amount","Sequence":87,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"afee_reason","Description":"Invoice Additional Fee Amount Reason","Sequence":88,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"fbil","Description":"Frequency of Billing","Sequence":89,"DataType":"String","Length":50,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"org_e_inv_no","Description":"Original E-Invoice Reference Number","Sequence":90,"DataType":"String","Length":50,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"term","Description":"Payment Term","Sequence":91,"DataType":"String","Length":120,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"bref","Description":"Bill Reference Number","Sequence":92,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ftrd","Description":"Free Trade Agreement(FTA) Information","Sequence":93,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"anum","Description":"Authorisation Number for Certified Exporter","Sequence":94,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ochg","Description":"Details of other charges","Sequence":95,"DataType":"Boolean","Length":1,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ochg_amnt","Description":"Details of other charges - Amount","Sequence":96,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ochg_reason","Description":"Details of other charges - Reason","Sequence":97,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"det_tax","Description":"Detail of Tax Exemption(Invoice Level)","Sequence":98,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"bsdt","Description":"Billing Period Start Date","Sequence":99,"DataType":"Date","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"bedt","Description":"Billing Period End Date","Sequence":100,"DataType":"Date","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"amnt_ex","Description":"Amount Exemption from Tax(Invoice Level)","Sequence":101,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"dshp","Description":"Dropshipment","Sequence":102,"DataType":"Boolean","Length":1,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"submission_uid","Description":"LHDN Submission UID","Sequence":103,"DataType":"String","Length":26,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"doc_uuid","Description":"LHDN UUID","Sequence":104,"DataType":"String","Length":26,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"esta","Description":"LHDN Status","Sequence":105,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"lhdn_status","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"err_msg","Description":"Error Message","Sequence":106,"DataType":"String","Length":600,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"e_invdt","Description":"E-Invoice Date \u0026 Time","Sequence":107,"DataType":"DateTime","Length":25,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"einv_stat","Description":"E-Invoice Status","Sequence":108,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"einv_status","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"etim","Description":"LHDN Validated Date \u0026 Time","Sequence":109,"DataType":"DateTime","Length":25,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"modi_stat","Description":"Header Modification Status","Sequence":110,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"m_status","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"src_type","Description":"Sales Type","Sequence":111,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"src_inv_type","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"inv_pdf","Description":"PDF Resource ID","Sequence":112,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference0","Description":"LN Invoice Date","Sequence":113,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference1","Description":"Reference 1","Sequence":114,"DataType":"String","Length":500,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference2","Description":"Reference 2","Sequence":115,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference3","Description":"Reference 3","Sequence":116,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference4","Description":"Reference 4","Sequence":117,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference5","Description":"Reference 5","Sequence":118,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference6","Description":"Reference 6","Sequence":119,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference7","Description":"Reference 7","Sequence":120,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference8","Description":"Reference 8","Sequence":121,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference9","Description":"Reference 9","Sequence":122,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_code","Description":"Supplier Code","Sequence":123,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"qr_code","Description":"QR Code","Sequence":124,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"org_doc_uuid","Description":"Original Document UUID","Sequence":125,"DataType":"String","Length":26,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"einv_version","Description":"E-Invoice Version","Sequence":126,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""}],"Segments":[],"AdditionalProps":null,"References":[{"Name":"einv_header","Sequence":1,"Columns":["dataset"],"RefersTo":"data_set","ReferenceFields":["data_set"],"OnDelete":"RESTRICT","OnUpdate":"RESTRICT"}],"Indices":[],"SharedTable":false,"CreatedBy":"malai","ModifiedBy":"parthi","CreatedDate":"2024-06-26T18:20:00.911604+08:00","ModifiedDate":"2025-03-12T20:04:38.256501+08:00","EnableComments":false,"ReferenceFields":null,"ReadQuery":"SELECT * FROM {{einv_header}} "},"BeforeSave":"//**** Hook before_save Created by malai on 24-Apr-2024 11:08:36\nvar einvois = require(\"./scripts/Business_Objects/createEinvoice\")\nfunction before_save(){\n\tif (jscall.mode == \"insert\"){\n\t\t// jscall.input.e_inv_no = jscall.input.e_inv_no.toUpperCase() // convert to uppercase\n\t\tentity_ds = CralDB.QueryByComp(`select skip_einv_no_iter from {{entity_data_set}} where sup_company=${jscall.input.comp} and data_set='${jscall.input.dataset}'`, jscall.company)\n\t\tif (entity_ds.length == 0){\n\t\t\tjscall_error = `Entity Data Set is Not Maintained for ${jscall.input.comp} - ${jscall.input.dataset}`\n\t\t\treturn false;\n\t\t}\n\t\tif (!jscall.input.e_inv_no){\n\t\t\titer_num = CralDB.QueryByComp(\"select comp,tran,idoc,src_type from {{einv_header}} where comp='$1' and tran='$2' and idoc=$3\", jscall.company, jscall.input.comp, jscall.input.tran, parseInt(jscall.input.idoc))\n\t\t\tfor (i=0;i\u003citer_num.length;i++){\n\t\t\t\tif (jscall.input.src_type == iter_num[i].src_type){\n\t\t\t\t\tjscall_error = \"Record Alreday Exists\"\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t\tjscall.input.e_inv_no = jscall.input.tran + jscall.input.idoc.toString()\n\n\t\t\tif (!entity_ds[0].skip_einv_no_iter){\n\t\t\t\titeration = (iter_num?.length + 1).toString()\n\t\t\t\twhile(iteration.length \u003c 2){\n\t\t\t\t\titeration = \"0\" + iteration\n\t\t\t\t}\n\t\t\t\tjscall.input.e_inv_no = jscall.input.e_inv_no + \"_\" + iteration\n\t\t\t}\n\t\t}\n\t\tjscall.input.e_invdt = einvois.getCurrentDateTimeUTC()\n\t\t// fin_fld = [\"rate\", \"tote\", \"toti\", \"tott\", \"pamt\", \"tpat\", \"tnat\", \"tdis\", \"tfee\", \"ramt\", \"ttax\", \"ttat\", \"adis\", \"afee\", \"ochg_amnt\", \"amnt_ex\"]\n\t\t// for (i=0;i\u003cfin_fld?.length;i++){\n\t\t// \tjscall.input[fin_fld[i]] = parseFloat(jscall.input[fin_fld[i]].toFixed(2))\n\t\t// }\n\t}\n\tdebug(\"out\" + jscall.input.e_inv_no)\n\tif (jscall.input.idoc != \"\" \u0026\u0026 jscall.input.idoc != null \u0026\u0026 jscall.input.idoc != undefined){\n\t\tjscall.input.idoc = jscall.input.idoc.toString()\n\t}\n\t// isPDFAvil = CralDB.QueryByComp(\"select inv_pdf from {{einv_header}} where e_inv_no='$1'\", jscall.company, jscall.input.e_inv_no)\n\t// println(isPDFAvil)\n\t// if (isPDFAvil.length != 0){\n\t// \tif (jscall.input.einv_stat == \"30\" \u0026\u0026 (isPDFAvil[0].inv_pdf == \"\" || isPDFAvil[0].inv_pdf == null || isPDFAvil[0].inv_pdf == undefined)){\n\t// \t\tprintln(\"IN\")\n\t// \t\tpdf = printPDF.printReportLayout(jscall.input.e_inv_no)\n\t// \t\tif (pdf.result != null || pdf.result != undefined){\n\t// \t\t\tif (pdf.result == \"\"){\n\t// \t\t\t\tjscall_error = pdf.error\n\t// \t\t\t\treturn false\n\t// \t\t\t}\n\t// \t\t\tjscall.input.inv_pdf = pdf.result\n\t// \t\t}\n\t// \t}\n\t// }\n\treturn true;\n}","AfterSave":"","BeforeDelete":"//**** Hook before_delete Created by malai on 02-May-2024 13:17:13\n\t\t\tfunction before_delete(){\n\t\t\t\t// jscall_error = JSON.stringify(jscall.input)\n\t\t\t\tprintln(jscall.input)\n\t\t\t\t// return false\n\t\t\t\tline_records = CralDB.QueryByComp(\"select e_inv_no,line from {{einv_lines}} where e_inv_no='$1'\", jscall.company, jscall.input.e_inv_no);\n\t\t\t\tfor (let i = 0; i \u003c line_records.length; i++){\n\t\t\t\t\tret = CralDB.PublishTopic(\"einv_lines\", jscall.company, \"Delete\", line_records[i], jscall.user)\n\t\t\t\t\tif (ret.Success == false){\n\t\t\t\t\t\tjscall_error = ret.Message\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvld_records = jscall.RunQuery(`DELETE FROM einv_validation_${jscall.company.toString().padStart(4, '0')} where einv_code='${jscall.input.e_inv_no}'`)\n\t\t\t\tif (vld_records.error){\n\t\t\t\t\tjscall_error = vld_records.error;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t  return true;\n\t\t\t}","AfterDelete":""},{"Topic":{"Name":"einv_lines","Description":"E-Invoice Lines","Keys":["e_inv_no","line"],"SendAlertOnFail":true,"DistributionList":[],"HotTopic":true,"FieldDefs":[{"FieldName":"e_inv_no","Description":"E-Invoice Number","Sequence":1,"DataType":"String","Length":50,"IsKey":true,"IndexSequence":1,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"line","Description":"Line","Sequence":2,"DataType":"Integer","Length":4,"IsKey":true,"IndexSequence":2,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"cuni","Description":"Unit of Measure","Sequence":3,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ccty","Description":"Country of Origin","Sequence":4,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"clas_grp","Description":"Classification Group","Sequence":5,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"class_map","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"clas","Description":"Classification","Sequence":6,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"item","Description":"Item Code","Sequence":7,"DataType":"String","Length":47,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"item_desc","Description":"Item Description","Sequence":8,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pric","Description":"Price","Sequence":9,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pvat","Description":"Tax Rate","Sequence":10,"DataType":"Float","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"txai","Description":"Tax Amount","Sequence":11,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ceno","Description":"Tax Exemption Certificate Number","Sequence":12,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"amtt","Description":"Amount Exempted from Tax","Sequence":13,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"stot","Description":"Sub Total","Sequence":14,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"amti","Description":"Total Excluding Tax","Sequence":15,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"dqua","Description":"Quantity","Sequence":16,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"disc","Description":"Discount Rate","Sequence":17,"DataType":"Float","Length":6,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ldai","Description":"Discount Amount","Sequence":18,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ccde","Description":"Product Tariff","Sequence":19,"DataType":"String","Length":25,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"feer","Description":"Fee / Charge Rate","Sequence":20,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"feea","Description":"Fee / Charge Amount","Sequence":21,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"disc_reason","Description":"Discount Reason","Sequence":22,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"fee_reason","Description":"Fees Reason","Sequence":23,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"err_msg","Description":"Invoice Line Error","Sequence":24,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"lsta","Description":"Invoice Line Status","Sequence":25,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"einv_status","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"modi_lsta","Description":"Line Modification Status","Sequence":26,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"m_status","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"cvat","Description":"Tax Type","Sequence":27,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference0","Description":"Reference 0","Sequence":28,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference1","Description":"Reference 1","Sequence":29,"DataType":"String","Length":5000,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference2","Description":"Reference 2","Sequence":30,"DataType":"String","Length":5000,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference3","Description":"Reference 3","Sequence":31,"DataType":"String","Length":5000,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference4","Description":"Reference 4","Sequence":32,"DataType":"String","Length":5000,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference5","Description":"Reference 5","Sequence":33,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference6","Description":"Reference 6","Sequence":34,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference7","Description":"Reference 7","Sequence":35,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference8","Description":"Reference 8","Sequence":36,"DataType":"String","Length":0,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference9","Description":"Reference 9","Sequence":37,"DataType":"String","Length":5000,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference10","Description":"Reference 10","Sequence":38,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference11","Description":"Reference 11","Sequence":39,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference12","Description":"Reference 12","Sequence":40,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference13","Description":"Reference 13","Sequence":41,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference14","Description":"Reference 14","Sequence":42,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference15","Description":"Reference 15","Sequence":43,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference16","Description":"Reference 16","Sequence":44,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference17","Description":"Reference 17","Sequence":45,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference18","Description":"Reference 18","Sequence":46,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference19","Description":"Reference 19","Sequence":47,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference20","Description":"Reference 20","Sequence":48,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""}],"Segments":[],"AdditionalProps":null,"References":[],"Indices":[],"SharedTable":false,"CreatedBy":"malai","ModifiedBy":"malai","CreatedDate":"2024-06-26T19:54:27.033737+08:00","ModifiedDate":"2025-03-10T20:22:55.271047+08:00","EnableComments":false,"ReferenceFields":null,"ReadQuery":"SELECT * FROM {{einv_lines}} "},"BeforeSave":"//**** Hook before_save Created by malai on 02-May-2024 09:52:04\n\t\t\tfunction before_save(){\n\t\t\t\t// jscall.input.idoc = jscall.input.idoc.toString()\n\t\t\t  return true;\n\t\t\t}","AfterSave":"//**** Hook after_save Created by malai on 30-Apr-2024 16:31:04\n\t\t\tfunction after_save(){\n\t\t\t\tif (jscall.mode.toUpperCase() == \"INSERT\"){\n\t\t\t\t\tline_val = CralDB.QueryByComp(\"select e_inv_no,line_cnt from {{einv_header}} where e_inv_no='$1'\", jscall.company, jscall.input.e_inv_no)\n\t\t\t\t\tif (line_val.length == 0){\n\t\t\t\t\t\tjscall_error = \"Header Not Found\"\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tline_count = line_val[0].line_cnt + 1\n\t\t\t\t\t\tupdate_line_count = line_val[0]\n\t\t\t\t\t\tupdate_line_count.line_cnt = line_count\n\t\t\t\t\t\tupdate_ret = CralDB.PublishTopic(\"einv_header\", jscall.company, \"Update\", update_line_count, jscall.user)\n\t\t\t\t\t\tif (update_ret.Success != true){\n\t\t\t\t\t\t\t// Line Count Not Updated Error should be handled\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t  return true;\n\t\t\t}","BeforeDelete":"","AfterDelete":"//**** Hook after_delete Created by malai on 30-Apr-2024 17:09:49\n\t\t\tfunction after_delete(){\n\t\t\t  line_val = CralDB.QueryByComp(\"select e_inv_no,line_cnt from {{einv_header}} where e_inv_no='$1'\", jscall.company, jscall.input.e_inv_no)\n\t\t\t\tif (line_val.length == 0){\n\t\t\t\t\tjscall_error = \"Header Not Found\"\n\t\t\t\t\t// return false;\n\t\t\t\t} else {\n\t\t\t\t\tline_count = line_val[0].line_cnt - 1\n\t\t\t\t\tupdate_line_count = line_val[0]\n\t\t\t\t\tupdate_line_count.line_cnt = line_count\n\t\t\t\t\tupdate_ret = CralDB.PublishTopic(\"einv_header\", jscall.company, \"Update\", update_line_count, jscall.user)\n\t\t\t\t\tif (update_ret.Success != true){\n\t\t\t\t\t\t// Line Count Not Updated Error should be handled\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t  return true;\n\t\t\t}"},{"Topic":{"Name":"inv_interim_excl","Description":"Invoice Interim - Excel","Keys":["inv_no","line"],"SendAlertOnFail":true,"DistributionList":[],"HotTopic":true,"FieldDefs":[{"FieldName":"inv_no","Description":"E-Invoice Number","Sequence":1,"DataType":"String","Length":50,"IsKey":true,"IndexSequence":1,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"line","Description":"Invoice Line Number","Sequence":2,"DataType":"Integer","Length":4,"IsKey":true,"IndexSequence":2,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"comp","Description":"Supplier Code","Sequence":3,"DataType":"Integer","Length":4,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tran","Description":"Finance Type","Sequence":4,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"idoc","Description":"Invoice Number","Sequence":5,"DataType":"Integer","Length":8,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"doct","Description":"Invoice Type","Sequence":6,"DataType":"String","Length":50,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ccur","Description":"Invoice Currency Code","Sequence":7,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"paym","Description":"Payment Mode","Sequence":8,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"cvat","Description":"Tax Type","Sequence":9,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sctg","Description":"Sales Category","Sequence":10,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"sales_catg","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"data_set","Description":"Dataset","Sequence":11,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"line_cnt","Description":"Line Count","Sequence":12,"DataType":"Integer","Length":4,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"s_line_cnt","Description":"Source Line Count","Sequence":13,"DataType":"Integer","Length":4,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_name","Description":"Supplier Name","Sequence":14,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_cont_num","Description":"Supplier Contact Number","Sequence":15,"DataType":"String","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_email","Description":"Supplier Mail","Sequence":16,"DataType":"String","Length":320,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_sst_reg","Description":"Supplier SST Registration","Sequence":17,"DataType":"String","Length":35,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_ttx_no","Description":"Supplier Tourism Tax Number","Sequence":18,"DataType":"String","Length":17,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_tin","Description":"Supplier TIN","Sequence":19,"DataType":"String","Length":14,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_reg_brn","Description":"Supplier Registration Number","Sequence":20,"DataType":"String","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_reg_nric","Description":"Supplier NRIC","Sequence":21,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_reg_passport","Description":"Supplier Passport Number","Sequence":22,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_reg_army","Description":"Supplier Army Identification","Sequence":23,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_badsca","Description":"Supplier Business Activity","Sequence":24,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_bank_acc","Description":"Supplier Bank Account Number","Sequence":25,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_msic","Description":"Supplier MSIC Code","Sequence":26,"DataType":"String","Length":5,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_adrs","Description":"Supplier Address Code","Sequence":27,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_city","Description":"Supplier City","Sequence":28,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_postal_zone","Description":"Supplier Postal Code","Sequence":29,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_adrs_line0","Description":"Supplier Address Line 0","Sequence":30,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_adrs_line1","Description":"Supplier Address Line 1","Sequence":31,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_adrs_line2","Description":"Supplier Address Line 2","Sequence":32,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_country","Description":"Supplier Country Code","Sequence":33,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"sup_cste","Description":"Supplier State Code","Sequence":34,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"inv_bp","Description":"Buyer Code","Sequence":35,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_name","Description":"Buyer Name","Sequence":36,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_cont_num","Description":"Buyer Contact Number","Sequence":37,"DataType":"String","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_email","Description":"Buyer Mail","Sequence":38,"DataType":"String","Length":320,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_sst_reg","Description":"Buyer SST Registration","Sequence":39,"DataType":"String","Length":35,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_tin","Description":"Buyer TIN","Sequence":40,"DataType":"String","Length":17,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_reg_brn","Description":"Buyer Registration Number","Sequence":41,"DataType":"String","Length":14,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_reg_nric","Description":"Buyer NRIC","Sequence":42,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_reg_passport","Description":"Buyer Passport","Sequence":43,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_reg_army","Description":"Buyer Army","Sequence":44,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_adrs","Description":"Buyer Address","Sequence":45,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_city","Description":"Buyer City","Sequence":46,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_postal_zone","Description":"Buyer Postal Code","Sequence":47,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_adrs_line0","Description":"Buyer Address Line 0","Sequence":48,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_adrs_line1","Description":"Buyer Address Line 1","Sequence":49,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_adrs_line2","Description":"Buyer Address Line 2","Sequence":50,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_country","Description":"Buyer Country Code","Sequence":51,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"buy_cste","Description":"Buyer State Code","Sequence":52,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"dtrm","Description":"Incoterms","Sequence":53,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_bp","Description":"Shipper Code","Sequence":54,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_name","Description":"Shipper Name","Sequence":55,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_tin","Description":"Shipper TIN","Sequence":56,"DataType":"String","Length":14,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_reg_brn","Description":"Shipper Registration Number","Sequence":57,"DataType":"String","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_reg_nric","Description":"Shipper NRIC","Sequence":58,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_reg_passport","Description":"Shipper Passport","Sequence":59,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_reg_army","Description":"Shipper Army","Sequence":60,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_adrs","Description":"Shipper Address Code","Sequence":61,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_city","Description":"Shipper City","Sequence":62,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_postal_zone","Description":"Shipper Postal Code","Sequence":63,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_adrs_line0","Description":"Shipper Address Line 0","Sequence":64,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_adrs_line1","Description":"Shipper Address Line 1","Sequence":65,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_adrs_line2","Description":"Shipper Address Line 2","Sequence":66,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_country","Description":"Shipper Country Code","Sequence":67,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ship_cste","Description":"Shipper State Code","Sequence":68,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"frm1","Description":"Reference No of Customs form No 1, 9, etc","Sequence":69,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"frm2","Description":"Reference Number of Customs Form No.2","Sequence":70,"DataType":"String","Length":12,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"rate","Description":"Currency Exchange Rate","Sequence":71,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tote","Description":"Total Excluding Tax","Sequence":72,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"toti","Description":"Total Including Tax","Sequence":73,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tott","Description":"Total Tax Amount","Sequence":74,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pamt","Description":"PrePayment Amount","Sequence":75,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pydt","Description":"PrePayment Date","Sequence":76,"DataType":"Date","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pytm","Description":"PrePayment Time","Sequence":77,"DataType":"DateTime","Length":25,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pref","Description":"PrePayment Reference Number","Sequence":78,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tpat","Description":"Total Payable Amount","Sequence":79,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tnat","Description":"Total Net Amount","Sequence":80,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tdis","Description":"Total Discount Value","Sequence":81,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tfee","Description":"Total Fee / Charge Amount","Sequence":82,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ramt","Description":"Rounding Amount","Sequence":83,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ttax","Description":"Total Taxable Amount Per Tax Type","Sequence":84,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ttat","Description":"Total Tax Amount Per Tax Type","Sequence":85,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"adis","Description":"Invoice Additional Discount Amount","Sequence":86,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"adis_reason","Description":"Invoice Additional Discount Amount Reason","Sequence":87,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"afee","Description":"Invoice Additional Fee Amount","Sequence":88,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"afee_reason","Description":"Invoice Additional Fee Amount Reason","Sequence":89,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"fbil","Description":"Frequency of Billing","Sequence":90,"DataType":"String","Length":50,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"org_e_inv_no","Description":"Original E-Invoice Reference Number","Sequence":91,"DataType":"String","Length":50,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"term","Description":"Payment Term","Sequence":92,"DataType":"String","Length":120,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"bref","Description":"Bill Reference Number","Sequence":93,"DataType":"String","Length":150,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ftrd","Description":"Free Trade Agreement(FTA) Information","Sequence":94,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"anum","Description":"Authorisation Number for Certified Exporter","Sequence":95,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ochg","Description":"Details of other charges","Sequence":96,"DataType":"Boolean","Length":1,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ochg_amnt","Description":"Details of other charges - Amount","Sequence":97,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ochg_reason","Description":"Details of other charges - Reason","Sequence":98,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"det_tax","Description":"Detail of Tax Exemption(Invoice Level)","Sequence":99,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"bsdt","Description":"Billing Period Start Date","Sequence":100,"DataType":"Date","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"bedt","Description":"Billing Period End Date","Sequence":101,"DataType":"Date","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"amnt_ex","Description":"Amount Exemption from Tax(Invoice Level)","Sequence":102,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"dshp","Description":"Dropshipment","Sequence":103,"DataType":"Boolean","Length":1,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"cuni","Description":"Unit of Measure","Sequence":104,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ccty","Description":"Country of Origin","Sequence":105,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"clas_grp","Description":"Classification Group","Sequence":106,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"class_map","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"clas","Description":"Classification","Sequence":107,"DataType":"String","Length":3,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"item","Description":"Item Code","Sequence":108,"DataType":"String","Length":47,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"item_desc","Description":"Item Description","Sequence":109,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pric","Description":"Price","Sequence":110,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"pvat","Description":"Tax Rate","Sequence":111,"DataType":"Float","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"txai","Description":"Tax Amount","Sequence":112,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"tex_cer_no","Description":"Tax Exemption Certificate Number","Sequence":113,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"amtt","Description":"Amount","Sequence":114,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"stot","Description":"Sub Total","Sequence":115,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"amti","Description":"Line Invoice Amount","Sequence":116,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"dqua","Description":"Delivered Quantity","Sequence":117,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"disc","Description":"Discount %","Sequence":118,"DataType":"Float","Length":6,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ldai","Description":"Line Discount Amount","Sequence":119,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"ccde","Description":"Product Tariff","Sequence":120,"DataType":"String","Length":25,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"feer","Description":"Fee / Charge Rate","Sequence":121,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"feea","Description":"Fee / Charge Amount","Sequence":122,"DataType":"Float","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"disc_reason","Description":"Discount Reason","Sequence":123,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"fee_reason","Description":"Fees Reason","Sequence":124,"DataType":"String","Length":300,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"fld_category","Description":"Field Category","Sequence":125,"DataType":"String","Length":30,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"fld_category","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"src_type","Description":"Sales Type","Sequence":126,"DataType":"String","Length":20,"IsKey":false,"IndexSequence":0,"Props":{"List":true,"ListID":"src_inv_type","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"temp_code","Description":"Template Code","Sequence":127,"DataType":"String","Length":9,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"mandatory","Description":"Mandatory Fields","Sequence":128,"DataType":"Json","Length":200,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"unmapped","Description":"Unmapped Data","Sequence":129,"DataType":"Json","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"upload_id","Description":"Upload ID","Sequence":130,"DataType":"Integer","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"upload_id","RefersTo":"uploaded_file_details"},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"org_doc_uuid","Description":"Original Document UUID","Sequence":131,"DataType":"String","Length":26,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"err_msg","Description":"Error message","Sequence":132,"DataType":"String","Length":400,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference1","Description":"Reference1","Sequence":133,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference2","Description":"Reference2","Sequence":134,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference3","Description":"Reference3","Sequence":135,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference4","Description":"Reference4","Sequence":136,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference5","Description":"Reference5","Sequence":137,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference6","Description":"Reference6","Sequence":138,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference7","Description":"Reference7","Sequence":139,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference8","Description":"Reference8","Sequence":140,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"reference9","Description":"Reference9","Sequence":141,"DataType":"String","Length":100,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""},{"FieldName":"l_cvat","Description":"Line Tax Type","Sequence":142,"DataType":"String","Length":10,"IsKey":false,"IndexSequence":0,"Props":{"List":false,"ListID":"","ReferenceField":"","RefersTo":""},"SetDefault":false,"Default":"","AutoGen":false,"Mandatory":false,"ClassValidators":"","DecimalPlaces":0,"UIComponent":""}],"Segments":[],"AdditionalProps":null,"References":[{"Name":"inv_interim_excl","Sequence":1,"Columns":["data_set"],"RefersTo":"data_set","ReferenceFields":["data_set"],"OnDelete":"RESTRICT","OnUpdate":"RESTRICT"}],"Indices":[{"Topic":"inv_interim_excl","IndexNo":1,"Description":"template_code","Fields":["temp_code","inv_no","line"],"Unique":false,"Cascade":false}],"SharedTable":false,"CreatedBy":"malai","ModifiedBy":"parthi","CreatedDate":"2024-07-23T12:58:01.882613+08:00","ModifiedDate":"2025-03-14T19:18:53.240932+08:00","EnableComments":false,"ReferenceFields":null,"ReadQuery":"SELECT * FROM {{inv_interim_excl}} "},"BeforeSave":"//**** Hook before_save Created by malai on 29-Jul-2024 15:54:33\nfunction before_save(){\n\t// if (jscall.mode == \"insert\"){\n\t// \tjscall.input.inv_no = jscall.input.inv_no.toUpperCase() // convert to uppercase\n\t// }\n\tif (!CralDB.QueryByComp(`select line from {{inv_interim_excl}} where inv_no='${jscall.input.inv_no}' and line=${jscall.input.line}`, jscall.company).length){\n\t\tentity_ds = CralDB.QueryByComp(`select skip_master,skip_einv_no_iter from {{entity_data_set}} where sup_company=${jscall.input.comp} and data_set='${jscall.input.data_set}'`, jscall.company)\n\t\tif (entity_ds.length == 0){\n\t\t\tjscall_error = `Entity Data Set is Not Maintained for ${jscall.input.comp} - ${jscall.input.data_set}`\n\t\t\treturn false;\n\t\t}\n\t\tif (!jscall.input.inv_no){\n\t\t\titer_num = CralDB.QueryByComp(\"select src_type,DISTINCT inv_no from {{inv_interim_excl}} where comp=$1 and tran='$2' and idoc=$3\", jscall.company, jscall.input.comp, jscall.input.tran, parseInt(jscall.input.idoc))\n\t\t\tfor (let i = 0; i \u003c iter_num.length; i++) {\n\t\t\t\tif (jscall.input.src_type === iter_num[i].src_type) {\n\t\t\t\t\tjscall.input.inv_no = iter_num[i].inv_no;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!jscall.input.inv_no) {\n\t\t\t\tjscall.input.inv_no = jscall.input.tran + jscall.input.idoc;\n\t\t\t\tif (!entity_ds[0].skip_einv_no_iter) {\n\t\t\t\t\tjscall.input.inv_no += `_${(iter_num.length + 1).toString().padStart(2, '0')}`;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// if (jscall.mode == \"insert\"){\n\n\t\t\t// }\n\n\t\t}\n\t\tjscall.input.inv_no = jscall.input.inv_no.toUpperCase() // convert to uppercase\n\t} else {\n\t\tif (!jscall.input.comp || !jscall.input.data_set){\n\t\t\trec = CralDB.QueryByComp(`select comp,data_set from {{inv_interim_excl}} where inv_no='${jscall.input.inv_no.toUpperCase}'`, jscall.company)\n\t\t\tjscall.input.comp = rec[0].comp\n\t\t\tjscall.input.data_set = rec[0].data_set\n\t\t}\n\t\tentity_ds = CralDB.QueryByComp(`select skip_master,skip_einv_no_iter from {{entity_data_set}} where sup_company=${jscall.input.comp} and data_set='${jscall.input.data_set}'`, jscall.company)\n\t\tif (entity_ds.length == 0){\n\t\t\tjscall_error = `Entity Data Set is Not Maintained for ${jscall.input.comp} - ${jscall.input.data_set}`\n\t\t\treturn false;\n\t\t}\n\t}\n\tif (jscall.input.idoc != \"\" \u0026\u0026 jscall.input.idoc != null \u0026\u0026 jscall.input.idoc != undefined){\n\t\tjscall.input.idoc = jscall.input.idoc.toString()\n\t}\n\tisSubmitted = CralDB.QueryByComp(`select einv_stat from {{einv_header}} where e_inv_no='${jscall.input.inv_no.toUpperCase()}'`, jscall.company)\n\tif (isSubmitted?.length != 0 \u0026\u0026 isSubmitted[0]?.einv_stat != \"60\"){\n\t\tjscall_error = \"Invoice Already Submitted\" // Message used for tracking in Excel upload. Message was handled in docUpload.\n\t\treturn false;\n\t}\n\tif (!entity_ds[0].skip_master){\n\t\tbuyer_update()\n\t\tadrs_update()\n\t\t\n\t\tif (jscall.input?.ccur){\n\t\t\tmaster_update = masterDataUpdate(\"currency_codes\", \"src_ccur\", jscall.input.ccur)\n\t\t\tCralUtil.LogInfo(\"ExcelUpload\" ,\"Currency\", master_update)\n\t\t}\n\t\tif (jscall.input?.cvat){\n\t\t\tmaster_update = masterDataUpdate(\"tax_types\", \"src_ttype\", jscall.input.cvat)\n\t\t\tCralUtil.LogInfo(\"ExcelUpload\" ,\"TaxTypes\", master_update)\n\t\t}\n\t\tif (jscall.input?.paym){\n\t\t\tmaster_update = masterDataUpdate(\"payment_modes\", \"src_paym\", jscall.input.paym)\n\t\t\tCralUtil.LogInfo(\"ExcelUpload\" ,\"PaymentModes\", master_update)\n\t\t}\n\t\tif (jscall.input?.sup_country){\n\t\t\tmaster_update = masterDataUpdate(\"country_codes\", \"src_ccty\", jscall.input.sup_country)\n\t\t\tCralUtil.LogInfo(\"ExcelUpload\" ,\"Country\", master_update)\n\t\t}\n\t\tif (jscall.input?.buy_country){\n\t\t\tmaster_update = masterDataUpdate(\"country_codes\", \"src_ccty\", jscall.input.buy_country)\n\t\t\tCralUtil.LogInfo(\"ExcelUpload\" ,\"Country\", master_update)\n\t\t}\n\t\tif (jscall.input?.ship_country){\n\t\t\tmaster_update = masterDataUpdate(\"country_codes\", \"src_ccty\", jscall.input.ship_country)\n\t\t\tCralUtil.LogInfo(\"ExcelUpload\" ,\"Country\", master_update)\n\t\t}\n\t\tif (jscall.input?.cuni){\n\t\t\tmaster_update = masterDataUpdate(\"uom_codes\", \"src_unit\", jscall.input.cuni)\n\t\t\tCralUtil.LogInfo(\"ExcelUpload\" ,\"UOM\", master_update)\n\t\t}\n\t\tif (jscall.input?.sup_cste \u0026\u0026 jscall.input?.sup_country){\n\t\t\tmaster_update = masterDataUpdate(\"map_state_codes\", \"src_ccty\", jscall.input.sup_country, \"src_cste\", jscall.input.sup_cste)\n\t\t\tCralUtil.LogInfo(\"ExcelUpload\" ,\"State\", master_update)\n\t\t}\n\t\tif (jscall.input?.buy_cste \u0026\u0026 jscall.input?.buy_country){\n\t\t\tmaster_update = masterDataUpdate(\"map_state_codes\", \"src_ccty\", jscall.input.buy_country, \"src_cste\", jscall.input.buy_cste)\n\t\t\tCralUtil.LogInfo(\"ExcelUpload\" ,\"State\", master_update)\n\t\t}\n\t\tif (jscall.input?.ship_cste \u0026\u0026 jscall.input?.ship_country){\n\t\t\tmaster_update = masterDataUpdate(\"map_state_codes\", \"src_ccty\", jscall.input.ship_country,\"src_cste\",  jscall.input.ship_cste)\n\t\t\tCralUtil.LogInfo(\"ExcelUpload\" ,\"State\", master_update)\n\t\t}\n\t}\n\treturn true;\n}\n\nfunction buyer_update(){\n\tflds = [\n\t\t[\"inv_bp\", \"buy_name\", \"buy_tin\", \"buy_reg_nric\", \"buy_reg_brn\", \"buy_reg_passport\", \"buy_reg_army\", \"buy_sst_reg\", \"buy_email\", \"buy_cont_num\", \"buy_adrs\"],\n\t\t[\"ship_bp\", \"ship_name\", \"ship_tin\", \"ship_reg_nric\", \"ship_reg_brn\", \"ship_reg_passport\", \"ship_reg_army\", \"\", \"\", \"\", \"ship_adrs\"]\n\t]\n\tfor (i=0; i\u003cflds.length ; i++){\n\t\tif (flds[i].every(key =\u003e jscall.input.hasOwnProperty(key))){\n\t\t\tif (!jscall.input[flds[i][0]]){\n\t\t\t\tbuyer_code = findData(\"buyer_companies\", \"buy_code\",\n\t\t\t\t[\"buy_name\", \"buy_tin\", \"buy_reg_nric\", \"buy_reg_brn\", \"buy_reg_passport\", \"buy_reg_army\", \"buy_sst_reg\", \"buy_email\", \"buy_cont_num\", \"buy_adrs\"],\n\t\t\t\t[jscall.input[flds[i][1]], jscall.input[flds[i][2]], jscall.input[flds[i][3]], jscall.input[flds[i][4]], jscall.input[flds[i][5]],\n\t\t\t\tjscall.input[flds[i][6]], jscall.input[flds[i][7]], jscall.input[flds[i][8]], jscall.input[flds[i][9]], jscall.input[flds[i][10]]])\n\t\t\t\tif (buyer_code){\n\t\t\t\t\tjscall.input[flds[i][0]] = buyer_code\n\t\t\t\t} else {\n\t\t\t\t\tjscall.input[flds[i][0]] = getNewCode(\"EBP\", \"buyer_companies\", \"buy_code\")\n\t\t\t\t}\n\t\t\t}\n\t\t\tbuyer_update = masterDataUpdate(\"buyer_companies\", \"buy_code\", jscall.input[flds[i][0]],\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_name\", jscall.input[flds[i][1]],\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_tin\", jscall.input[flds[i][2]],\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_reg_nric\", jscall.input[flds[i][3]],\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_reg_brn\", jscall.input[flds[i][4]],\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_reg_passport\", jscall.input[flds[i][5]],\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_reg_army\", jscall.input[flds[i][6]],\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_sst\", (jscall.input[flds[i][7]])?true:false,\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_sst_reg\", jscall.input[flds[i][7]],\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_email\", jscall.input[flds[i][8]],\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_cont_num\", jscall.input[flds[i][9]],\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_adrs\", jscall.input[flds[i][10]],\n\t\t\t\t\t\t\t\t\t\t\t\t\"buy_comp_active\", true)\n\t\t\t// CralUtil.LogInfo(\"ExcelUpload\", \"Buyer Companies\", buyer_update)\n\t\t}\n\t}\n}\n\nfunction adrs_update(){\n\tadrs = []\n\tflds = [\n\t\t[\"sup_adrs\",\"sup_adrs_line0\", \"sup_adrs_line1\", \"sup_adrs_line2\", \"sup_city\", \"sup_postal_zone\", \"sup_cste\", \"sup_country\"], \n\t\t[\"buy_adrs\",\"buy_adrs_line0\", \"buy_adrs_line1\", \"buy_adrs_line2\", \"buy_city\", \"buy_postal_zone\", \"buy_cste\", \"buy_country\"], \n\t\t[\"ship_adrs\",\"ship_adrs_line0\", \"ship_adrs_line1\", \"ship_adrs_line2\", \"ship_city\", \"ship_postal_zone\", \"ship_cste\", \"ship_country\"]\n\t]\n\tfor (i=0; i\u003c flds.length; i++){\n\t\tif (flds[i].every(key =\u003e jscall.input.hasOwnProperty(key))){\n\t\t\tif (jscall.input[flds[i][4]] \u0026\u0026 jscall.input[flds[i][6]] \u0026\u0026 jscall.input[flds[i][7]]){\n\t\t\t\tif (!jscall.input[flds[i][0]]){\n\t\t\t\t\taddr_code = findData(\"address_master\", \"adrs_code\", \n\t\t\t\t\t[\"adrs_line0\", \"adrs_line1\", \"adrs_line2\", \"postal_zone\", \"adrs_city\", \"adrs_state\", \"adrs_country\"], \n\t\t\t\t\t[jscall.input[flds[i][1]], jscall.input[flds[i][2]], jscall.input[flds[i][3]], jscall.input[flds[i][5]], jscall.input[flds[i][4]], jscall.input[flds[i][6]], jscall.input[flds[i][7]]])\n\t\t\t\t\tif (addr_code){\n\t\t\t\t\t\tjscall.input[flds[i][0]] = addr_code\n\t\t\t\t\t} else {\n\t\t\t\t\t\tjscall.input[flds[i][0]] = getNewCode(\"EADR\", \"address_master\", \"adrs_code\")\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tadrs.push(masterDataUpdate(\"address_master\", \"adrs_code\", jscall.input[flds[i][0]],\n\t\t\t\t\t\t\t\t\t\t\t\"adrs_line0\", jscall.input[flds[i][1]],\n\t\t\t\t\t\t\t\t\t\t\t\"adrs_line1\", jscall.input[flds[i][2]],\n\t\t\t\t\t\t\t\t\t\t\t\"adrs_line2\", jscall.input[flds[i][3]],\n\t\t\t\t\t\t\t\t\t\t\t\"postal_zone\", jscall.input[flds[i][5]],\n\t\t\t\t\t\t\t\t\t\t\t\"adrs_city\", jscall.input[flds[i][4]],\n\t\t\t\t\t\t\t\t\t\t\t\"adrs_state\", jscall.input[flds[i][6]],\n\t\t\t\t\t\t\t\t\t\t\t\"adrs_country\", jscall.input[flds[i][7]]))\n\t\t\t}\n\t\t}\n\t}\n\treturn adrs\n}\n\nfunction getNewCode(string, table, field)\n{\n    max_val = CralDB.QueryByComp(`select MAX(${field}) from {{${table}}} where LEFT(${field},${string.length})='${string}'`, jscall.company)\n\tif (max_val[0]?.max){\n\t\treturn string + ((parseInt((max_val[0].max).slice(string.length)) + 1).toString()).padStart(max_val[0].max.length - string.length, '0')\n\t} else {\n\t\treturn string + (\"1\").padStart(9 - string.length, '0')\n\t}\n}\n\nfunction findData(topic, key_field, tbl_fields, tbl_values){\n\twhere_cond = \"\"\n\tfor (j = 0; j \u003c Math.min(tbl_fields.length, tbl_values.length); j++){\n\t\tif (tbl_values[j]){\n\t\t\tif (!where_cond){\n\t\t\t\twhere_cond = `${tbl_fields[j]}='${tbl_values[j]}'`\n\t\t\t} else {\n\t\t\t\twhere_cond = `${where_cond} and ${tbl_fields[j]}='${tbl_values[j]}'`\n\t\t\t}\n\t\t}\n\t}\n\tquery = `SELECT ${key_field} FROM {{${topic}}} WHERE ` + where_cond\n\tqret = CralDB.QueryByComp(query, jscall.company)\n\t// if (qret?.length == 1){\n\tif (qret?.length != 0){\n\t\treturn qret[0][key_field]\n\t}\n\treturn \"\"\n}\n\nfunction masterDataUpdate(topic, ...args){\n\tpayload = {\n\t\t\"data_set\": jscall.input.data_set\n\t}\n\tfor (i=0;i\u003cargs.length;i++){\n\t\tif (args[i+1]){\n\t\t\tpayload[args[i]] = args[++i]\n\t\t} else {\n\t\t\ti += 1\n\t\t}\n\t}\n\tCralUtil.LogInfo(\"Excel-Upload Master Data: Payload\", topic, payload)\n\treturn CralDB.PublishTopic(topic, jscall.company, \"Upsert\", payload, jscall.user)\n}","AfterSave":"//**** Hook after_save Created by malai on 01-Aug-2024 13:59:06\n\nvar einvois = require(\"./scripts/Business_Objects/createEinvoice\")\nfunction after_save(){\n\tif (jscall.input?.data_set){\n\t\t// CralUtil.LogInfo(\"ExcelUpload\" ,\"Buyer\", (buyer_update()))\n\t\t// CralUtil.LogInfo(\"ExcelUpload\" ,\"Address\", (adrs_update()))\n\t\t// if (jscall.input?.ccur){\n\t\t// \tCralUtil.LogInfo(\"ExcelUpload\" ,\"Currency\", (masterUpdate(\"currency_codes\", \"src_ccur\", jscall.input.ccur)))\n\t\t// }\n\t\t// if (jscall.input?.cvat){\n\t\t// \tCralUtil.LogInfo(\"ExcelUpload\" ,\"TaxTypes\", (masterUpdate(\"tax_types\", \"src_ttype\", jscall.input.cvat)))\n\t\t// }\n\t\t// if (jscall.input?.paym){\n\t\t// \tCralUtil.LogInfo(\"ExcelUpload\" ,\"PaymentModes\", (masterUpdate(\"payment_modes\", \"src_paym\", jscall.input.paym)))\n\t\t// }\n\t\t// if (jscall.input?.sup_country){\n\t\t// \tCralUtil.LogInfo(\"ExcelUpload\" ,\"Country\", (masterUpdate(\"country_codes\", \"src_ccty\", jscall.input.sup_country)))\n\t\t// }\n\t\t// if (jscall.input?.buy_country){\n\t\t// \tCralUtil.LogInfo(\"ExcelUpload\" ,\"Country\", (masterUpdate(\"country_codes\", \"src_ccty\", jscall.input.buy_country)))\n\t\t// }\n\t\t// if (jscall.input?.ship_country){\n\t\t// \tCralUtil.LogInfo(\"ExcelUpload\" ,\"Country\", (masterUpdate(\"country_codes\", \"src_ccty\", jscall.input.ship_country)))\n\t\t// }\n\t}\n\treturn true;\n}\n\n// function ccur_update(){\n// \tpayload_ccur = {\n// \t\t\"data_set\": jscall.input.data_set,\n// \t\t\"src_ccur\": jscall.input.ccur\n// \t}\n// \treturn CralDB.PublishTopic(\"currency_codes\", jscall.company, \"Upsert\", payload_ccur, jscall.user)\n// }\n\n// function masterUpdate(topic, fld, value){\n// \tpayload = {\n// \t\t\"data_set\": jscall.input.data_set\n// \t}\n// \tpayload[fld] = value\n// \treturn CralDB.PublishTopic(topic, jscall.company, \"Upsert\", payload, jscall.user)\n// }\n\n// function buyer_update(){\n// \tif (jscall.input?.inv_bp \u0026\u0026 jscall.input.inv_bp == \"\u003cnil\u003e\"){\n// \t\tinv_bp = jscall.input.inv_bp\n// \t} else {\n// \t\tinv_bp = getNewCode(\"EBP\", \"buyer_companies\", \"buy_code\")\n// \t}\n//     payload_buyer = {\n//         \"data_set\": jscall.input.data_set,\n//         \"buy_code\": inv_bp,\n//         \"buy_name\": jscall.input.buy_name,\n//         \"buy_tin\": jscall.input.buy_tin,\n//         \"buy_reg_nric\": jscall.input.buy_reg_nric,\n//         \"buy_reg_brn\": jscall.input.buy_reg_brn,\n//         \"buy_reg_passport\": jscall.input.buy_reg_passport,\n//         \"buy_reg_army\": jscall.input.buy_reg_army,\n//         \"buy_sst\": (jscall.input?.buy_sst_reg)?true:false,\n//         \"buy_sst_reg\": jscall.input.buy_sst_reg,\n//         \"buy_email\": jscall.input.buy_email,\n//         \"buy_cont_num\": jscall.input.buy_cont_num,\n//         \"buy_adrs\": jscall.input.buy_adrs,\n//         \"buy_comp_active\": true,\n//         // \"buy_msic\": \"Lorem\",\n//         // \"buy_badsca\": \"LoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsumLoremipsum\",\n//         // \"buy_ttx\": true,\n//         // \"buy_ttx_reg\": \"LoremipsumLoremip\",\n//         // \"delf\": true,\n//         \"conso_buyer\": false\n//     }\n//     return CralDB.PublishTopic(\"buyer_companies\", jscall.company, \"Upsert\", payload_buyer, jscall.user)\n// }\n\n// function adrs_update(){\n// \tadrs = []\n// \tflds = [\n// \t\t[\"sup_adrs\",\"sup_adrs_line0\", \"sup_adrs_line1\", \"sup_adrs_line2\", \"sup_city\", \"sup_postal_zone\", \"sup_cste\", \"sup_country\"], \n// \t\t[\"buy_adrs\",\"buy_adrs_line0\", \"buy_adrs_line1\", \"buy_adrs_line2\", \"buy_city\", \"buy_postal_zone\", \"buy_cste\", \"buy_country\"], \n// \t\t[\"ship_adrs\",\"ship_adrs_line0\", \"ship_adrs_line1\", \"ship_adrs_line2\", \"ship_city\", \"ship_postal_zone\", \"ship_cste\", \"ship_country\"]\n// \t]\n// \tfor (i=0; i\u003c flds.length; i++){\n// \t\tif (jscall.input[flds[i][4]] \u0026\u0026 jscall.input[flds[i][6]] \u0026\u0026 jscall.input[flds[i][7]]){\n// \t\t\tif (jscall.input[flds[i][0]]){\n// \t\t\t\tadrs_code = jscall.input[flds[i][0]]\n// \t\t\t} else {\n// \t\t\t\tadrs_code = getNewCode(\"EADS\", \"address_master\", \"adrs_code\")\n// \t\t\t}\n// \t\t\tpayload_adrs = {\n// \t\t\t\t\"adrs_nama\": \"\",\n// \t\t\t\t\"adrs_line0\": jscall.input[flds[i][1]],\n// \t\t\t\t\"adrs_line1\": jscall.input[flds[i][2]],\n// \t\t\t\t\"adrs_line2\": jscall.input[flds[i][3]],\n// \t\t\t\t\"postal_zone\": jscall.input[flds[i][5]],\n// \t\t\t\t\"adrs_city\": jscall.input[flds[i][4]],\n// \t\t\t\t\"adrs_state\": jscall.input[flds[i][6]],\n// \t\t\t\t\"adrs_country\": jscall.input[flds[i][7]],\n// \t\t\t\t\"adrs_telp\": \"\",\n// \t\t\t\t\"delf\": false,\n// \t\t\t\t\"data_set\": jscall.input.data_set,\n// \t\t\t\t\"adrs_code\": adrs_code\n// \t\t\t}\n// \t\t\tadrs.push(CralDB.PublishTopic(\"address_master\", jscall.company, \"Upsert\", payload_adrs, jscall.user))\n// \t\t}\n// \t}\n// \treturn adrs\n// }\n\n// function getNewCode(string, table, field)\n// {\n//     max_val = CralDB.QueryByComp(`select MAX(${field}) from {{${table}}} where LEFT(${field},${string.length})='${string}'`, jscall.company)\n// \tif (max_val[0]?.max){\n// \t\treturn string + ((parseInt((max_val[0].max).slice(string.length)) + 1).toString()).padStart(9 - max_val[0].max.length, '0')\n// \t} else {\n// \t\treturn string + (\"1\").padStart(9 - string.length, '0')\n// \t}\n// }","BeforeDelete":"","AfterDelete":""}],"BizObjects":[{"Bizobj":{"ObjectName":"cancelInvoice","Description":"Cancellation","external":true,"input_struct":"","out_success":"","out_fail":""},"Script":"//**** Business Object cancelInvoice Created by parthi on 06-May-2024 17:24:52 ****//\r\n\r\nvar einvois = require(\"./scripts/Business_Objects/createEinvoice\")\r\n\r\nfunction cancelInvLines(){\r\n    header_data = CralDB.QueryByComp(`select e_inv_no,dataset,comp,tran,idoc,doct,src_type,inv_bp,ship_bp,sup_code from {{einv_header}} where comp=${jscall.input.Company} and tran='${jscall.input.TransactionType}' and idoc=${jscall.input.InvoiceNumber}`, jscall.company)\r\n    if (header_data?.length != 0){\r\n        \r\n        self_inv = false\r\n\r\n        let cncl_seq = CralDB.QueryByComp(`select count(e_inv_no) from {{cancel_header}} where e_inv_no='${header_data[0]?.e_inv_no}'`, jscall.company)[0].count + 1\r\n        let series = jscall.input.LNParameter?.ManualId ? jscall.input.LNParameter.ManualId : (jscall.input.LNParameter?.OrderSeries ? jscall.input.LNParameter.OrderSeries : \"\");\r\n        if (header_data[0].doct == \"11\" || header_data[0].doct == \"12\" || header_data[0].doct == \"13\" || header_data[0].doct == \"14\"){\r\n            self_inv = true\r\n        }\r\n        let with_rec = jscall.input.LNParameter?.WithReceipts ? jscall.input.LNParameter.WithReceipts.toUpperCase() == \"NO\" ? false : true : false\r\n        let scale = jscall.input.LNParameter?.Scale?.toUpperCase()\r\n        let err_message = isCancelAvailable(header_data[0].src_type, series, header_data[0].dataset,\r\n                                            header_data[0].comp,\r\n                                            self_inv ? header_data[0].sup_code : header_data[0].inv_bp, \r\n                                            self_inv ? '' : header_data[0].ship_bp, with_rec)\r\n        if (err_message){\r\n            return {\r\n                \"error\": err_message,\r\n                \"status\": false\r\n            }\r\n        }\r\n        \r\n        header_payload = {\r\n            \"e_inv_no\": header_data[0].e_inv_no,\r\n            \"seqn\": cncl_seq,\r\n            \"data_set\": header_data[0].dataset,\r\n            \"comp\": header_data[0].comp,\r\n            \"tran\": header_data[0].tran,\r\n            \"idoc\": header_data[0].idoc,\r\n            \"doct\": header_data[0].doct,\r\n            \"reason\": jscall.input.Reason,\r\n            \"adcn\": \"\",\r\n            \"cdte\": einvois.getCurrentDateTime(),\r\n            \"errm\": \"\",\r\n            \"with_ship\": jscall.input.LNParameter?.WithShipments ? jscall.input.LNParameter.WithShipments.toUpperCase() == \"NO\" ? false : true : false,\r\n            \"with_rec\": with_rec,\r\n            \"scale\": scale == \"UP\" ? \"10\" : scale == \"DOWN\" ? \"20\": \"\",\r\n            \"seri\": series,\r\n            \"ord_typ\": jscall.input.LNParameter?.OrderType ? jscall.input.LNParameter.OrderType : \"\",\r\n            \"sls_pur_off\": jscall.input.LNParameter?.SalesOffice ? jscall.input.LNParameter.SalesOffice : (jscall.input.LNParameter?.PurchaseOffice ? jscall.input.LNParameter.PurchaseOffice : \"\"),\r\n            \"ret_reason\": jscall.input.LNParameter?.ReturnReason ? jscall.input.LNParameter.ReturnReason : \"\",\r\n            \"tran_type\": jscall.input.LNParameter?.TransactionType ? jscall.input.LNParameter.TransactionType : \"\",\r\n            \"all_lines\": jscall.input.AllLines,\r\n            // \"target_doc\": \"\"\r\n        }\r\n        header_payload[\"target_doc\"] = getTargetDoc(header_data[0].src_type, header_payload.with_rec, header_payload.with_ship, header_data[0].doct)\r\n        \r\n        if (!header_payload[\"target_doc\"]){\r\n            return {\r\n                \"error\": \"Unable to Get Target Document.\",\r\n                \"status\": false\r\n            }\r\n        }\r\n        header_result = CralDB.PublishTopic(\"cancel_header\", jscall.company, \"Insert\", header_payload, jscall.user)\r\n        \r\n        if (header_result?.Success != true){\r\n            return {\r\n                \"error\": header_result,\r\n                \"status\": false\r\n            }\r\n        } else {\r\n            header_update_result = CralDB.PublishTopic(\"einv_header\", jscall.company, \"Update\", {\r\n                \"e_inv_no\": header_result.Message.e_inv_no,\r\n                \"einv_stat\": \"50\",\r\n                // \"esta\": \"50\",\r\n                \"modi_stat\": jscall.input.AllLines ? \"20\" : \"30\"\r\n            }, jscall.user)\r\n            if (!header_update_result?.Success){\r\n                CralUtil.LogInfo(\"CancelInvoice\", header_result.Message.e_inv_no, header_update_result)\r\n            }\r\n            jscall.input.Lines.forEach(line_rec =\u003e {\r\n                lines_payload = {\r\n                    \"e_inv_no\": header_result.Message.e_inv_no,\r\n                    \"seqn\": header_result.Message.seqn,\r\n                    \"line\": line_rec.line,\r\n                    \"comp\": header_result.Message.comp,\r\n                    \"tran\": header_result.Message.tran,\r\n                    \"idoc\": header_result.Message.idoc,\r\n                    \"reason\": line_rec.reason,\r\n                    \"adcn\": \"\",\r\n                    \"errm\": \"\"\r\n                }\r\n                result = CralDB.PublishTopic(\"cancel_line\", jscall.company, \"Insert\", lines_payload, jscall.user)\r\n                if (!result?.Success){\r\n                    CralUtil.LogInfo(\"Error_Cancelling\", header_result.Message.e_inv_no, {payload: lines_payload, results: result})\r\n                    return {\r\n                        \"error\": \"Unable to Cancel.\",\r\n                        \"status\": false\r\n                    }\r\n                } else {\r\n                    line_update_result = CralDB.PublishTopic(\"einv_lines\", jscall.company, \"Update\", {\r\n                        \"e_inv_no\": result.Message.e_inv_no,\r\n                        \"line\": result.Message.line,\r\n                        \"lsta\": \"50\",\r\n                        \"modi_lsta\": \"20\"\r\n                    }, jscall.user)\r\n                    if (!line_update_result?.Success){\r\n                        CralUtil.LogInfo(\"CancelInvoiceLineError\", result.Message.e_inv_no, line_update_result)\r\n                    }\r\n                }\r\n            })\r\n\r\n            // change modi_stat\r\n\r\n\r\n            return {\r\n                \"error\": \"\",\r\n                \"status\": true\r\n            }\r\n        }\r\n    } else {\r\n        return {\r\n            \"error\": \"Invoice Not Found\",\r\n            \"status\": false\r\n        }\r\n    }\r\n}\r\n\r\nfunction getCNDetails(){\r\n    results = []\r\n    cn_data = CralDB.QueryByComp(`select * from {{cancel_header}} where adcn=''`, jscall.company)\r\n    \r\n    cn_data.forEach(rec =\u003e {\r\n        results.push({\r\n            \"EInvoiceNumber\": rec.e_inv_no,\r\n            \"Sequence\": rec.seqn,\r\n            \"TargetDoc\": rec.target_doc,\r\n            \"AllLines\": rec.all_lines,\r\n            \"Company\": rec.comp,\r\n            \"InvoiceNumber\": rec.idoc,\r\n            \"DocumentType\": rec.doct,\r\n            \"TransactionType\": rec.tran,\r\n            \"Reason\": rec.reason,\r\n            // \"LNParameter\": {\r\n            //     \"Scale\": rec.scale,\r\n            //     \"ManualId\": rec.seri\r\n            // },\r\n            \"LNParameter\": getLNParams(rec),\r\n            \"Lines\": CralDB.QueryByComp(`select line as \"Line\", reason as \"Reason\" from {{cancel_line}} where e_inv_no='${rec.e_inv_no}' and seqn=${rec.seqn}`, jscall.company)\r\n        })\r\n    })\r\n\r\n    return results\r\n}\r\n\r\nfunction getLNParams(cncl_inv){\r\n    param_obj = {}\r\n    param_obj[\"Scale\"] = CralUtil.GetListDesc(\"scale\", cncl_inv.scale)\r\n    // if (cncl_inv.target_doc == \"10\" || cncl_inv.target_doc == \"20\" || cncl_inv.target_doc == \"30\"){\r\n    //     param_obj[\"WithReceipts\"] = cncl_inv.with_rec ? \"Yes\" : \"No\"\r\n    // }\r\n    switch (cncl_inv.target_doc){\r\n        case \"10\":\r\n            param_obj[\"WithReceipts\"] = cncl_inv.with_rec ? \"Yes\" : \"No\"\r\n            param_obj[\"ManualId\"] = cncl_inv.seri\r\n        break;\r\n        case \"20\":\r\n            param_obj[\"WithReceipts\"] = cncl_inv.with_rec ? \"Yes\" : \"No\"\r\n            param_obj[\"OrderType\"] = cncl_inv.ord_typ\r\n            param_obj[\"SalesOffice\"] = cncl_inv.sls_pur_off\r\n            param_obj[\"ReturnReason\"] = cncl_inv.ret_reason\r\n            param_obj[\"OrderSeries\"] = cncl_inv.seri\r\n        break;\r\n        case \"30\":\r\n            param_obj[\"WithReceipts\"] = cncl_inv.with_rec ? \"Yes\" : \"No\"\r\n            param_obj[\"TranType\"] = cncl_inv.tran_type\r\n        break;\r\n        case \"40\":\r\n            param_obj[\"WithShipments\"] = cncl_inv.with_ship ? \"Yes\" : \"No\"\r\n            param_obj[\"OrderType\"] = cncl_inv.ord_typ\r\n            param_obj[\"PurchaseOffice\"] = cncl_inv.sls_pur_off\r\n            param_obj[\"ReturnReason\"] = cncl_inv.ret_reason\r\n            param_obj[\"OrderSeries\"] = cncl_inv.seri\r\n        break;\r\n        case \"50\":\r\n            param_obj[\"WithShipments\"] = cncl_inv.with_ship ? \"Yes\" : \"No\"\r\n            param_obj[\"TranType\"] = cncl_inv.tran_type\r\n        break;\r\n    }\r\n    return param_obj\r\n}\r\n\r\nfunction updateAdditionalRef(){\r\n    let results = []\r\n    CralUtil.LogInfo(\"AdditionalRefUpdate\", \"cancel_header\", jscall.input)\r\n    jscall.input.forEach(rec =\u003e {\r\n        payload = {\r\n            // \"comp\": rec.Company,\r\n            // \"idoc\": rec.InvoiceNumber,\r\n            // \"tran\": rec.TransactionType,\r\n            \"e_inv_no\": rec.EInvoiceNumber,\r\n            \"seqn\": rec.Sequence,\r\n            \"adcn\": rec.AdditionalDoc,\r\n            \"errm\": rec.ErrorMessage\r\n        }\r\n        CralUtil.LogInfo(\"Test\", \"Test\", payload)\r\n        // results.push(CralDB.PublishTopic(\"cancel_header\", jscall.company, \"Update\", payload, jscall.user))\r\n        CralUtil.LogInfo(\"TestInsert\", \"Tracking\", CralDB.PublishTopic(\"cancel_header\", jscall.company, \"Update\", payload, jscall.user))\r\n        rec.Lines.forEach(rec_line =\u003e {\r\n            lines_payload = {\r\n                // \"comp\": rec.Company,\r\n                // \"idoc\": rec.InvoiceNumber,\r\n                // \"tran\": rec.TransactionType,\r\n                \"e_inv_no\": rec.EInvoiceNumber,\r\n                \"seqn\": rec.Sequence,\r\n                \"line\": rec_line.Line,\r\n                \"adcn\": rec_line.AdditionalLine,\r\n                \"errm\": rec_line.ErrorMessage\r\n            }\r\n            results.push(CralDB.PublishTopic(\"cancel_line\", jscall.company, \"Update\", lines_payload, jscall.user))\r\n            CralUtil.LogInfo(\"CancelDetail\", \"TrackingLine\", lines_payload)\r\n        })\r\n    })\r\n    results.forEach(update_ret =\u003e {\r\n        if (!update_ret?.Success){\r\n            CralUtil.LogInfo(\"CancellationUpdationError\", \"InvoiceCancellation\", update_ret)\r\n        }\r\n    })\r\n    return results\r\n}\r\n\r\nfunction isCancelAvailable(cncl_src_type, cncl_seri, data_set, company, buyer_code, shipper_code, with_rec){\r\n    CralUtil.LogInfo(\"CheckBuyer\", \"CancelInvoice\", [buyer_code, shipper_code])\r\n    // switch (cncl_src_type) {\r\n    //     case \"10\":\r\n    //         cncl_ngrp = CralDB.QueryByComp(`select man_inv_ngrp from {{number_defaults}} where data_set='${data_set}' and comp=${company}`, jscall.company)[0]?.man_inv_ngrp\r\n    //         cncl_type = \"Manuval Sales\"\r\n    //         // if (cncl_ngrp){\r\n    //         //     if ( !(CralDB.QueryByComp(`select * from {{number_grp}} where data_set='${data_set}' and ngrp='${cncl_ngrp}' and seri='${cncl_seri}'`, jscall.company).length) ){\r\n    //         //         return \"Manual ID Not Found\"\r\n    //         //     }\r\n    //         // } else {\r\n    //         //     return \"Number Group for Manuval Sales is Not Maintained.\"\r\n    //         // }\r\n    //         break;\r\n    //     case \"20\":\r\n    //         cncl_ngrp = CralDB.QueryByComp(`select man_soinv_ngrp from {{number_defaults}} where data_set='${data_set}' and comp=${company}`, jscall.company)[0]?.man_soinv_ngrp\r\n    //         cncl_type = \"SO Invoice\"\r\n    //         // if (cncl_ngrp){\r\n    //         //     if ( !(CralDB.QueryByComp(`select * from {{number_grp}} where data_set='${data_set}' and ngrp='${cncl_ngrp}' and seri='${cncl_seri}'`, jscall.company).length) ){\r\n    //         //         return \"Order Series Not Found\"\r\n    //         //     }   \r\n    //         // } else {\r\n    //         //     return \"Number Group for SO Invoice is Not Maintained.\"\r\n    //         // }\r\n    //         break;\r\n    // }\r\n\r\n    if (!with_rec){\r\n        cncl_ngrp = CralDB.QueryByComp(`select man_inv_ngrp from {{number_defaults}} where data_set='${data_set}' and comp=${company}`, jscall.company)[0]?.man_inv_ngrp\r\n        cncl_type = \"Manuval Sales\"\r\n    } else {\r\n        cncl_ngrp = CralDB.QueryByComp(`select man_soinv_ngrp from {{number_defaults}} where data_set='${data_set}' and comp=${company}`, jscall.company)[0]?.man_soinv_ngrp\r\n        cncl_type = \"SO Invoice\"\r\n    }\r\n\r\n    if (cncl_ngrp){\r\n        if ( !(CralDB.QueryByComp(`select * from {{number_grp}} where data_set='${data_set}' and ngrp='${cncl_ngrp}' and seri='${cncl_seri}'`, jscall.company).length) ){\r\n            return `Order Series Not Found for ${data_set} - ${cncl_ngrp} - ${cncl_seri}`\r\n        }   \r\n    } else {\r\n        return `Number Group for ${cncl_type} is Not Maintained.`\r\n    }\r\n\r\n    if (!isActiveBuyer(data_set, buyer_code) || shipper_code ? !isActiveBuyer(data_set, shipper_code) : false){\r\n        return \"Inactive BP\"\r\n    }\r\n    return \"\"\r\n}\r\n\r\nfunction isActiveBuyer(ds, code){\r\n    return CralDB.QueryByComp(`select buy_comp_active from {{buyer_companies}} where data_set='${ds}' and buy_code='${code}'`, jscall.company)[0]?.buy_comp_active\r\n}\r\n\r\nfunction getTargetDoc(srcType, withReceipt, withShipment, docType) {\r\n    if (docType == '02' || docType == '12'){\r\n        switch (srcType){\r\n            case \"10\": \r\n                return !withReceipt \u0026\u0026 !withShipment ? \"10\" : \"\";\r\n            case \"20\":\r\n                return withReceipt ? (withShipment ? \"\" : \"20\") : (withShipment ? \"20\" : \"10\");\r\n            case \"30\":\r\n            case \"50\":\r\n                return withReceipt ? (withShipment ? \"\" : \"40\") : (withShipment ? \"40\" : \"50\");\r\n            case \"40\":\r\n                return !withReceipt \u0026\u0026 !withShipment ? \"30\" : \"\";\r\n            default:\r\n                return \"\";\r\n        }\r\n    } else {\r\n        switch (srcType) {\r\n            case \"10\":\r\n                return !withReceipt ? \"10\" : \"\";\r\n            case \"20\":\r\n                return withReceipt ? \"20\" : \"10\";\r\n            case \"30\":\r\n            case \"50\":\r\n                return withShipment ? \"40\" : \"50\";\r\n            case \"40\":\r\n                return !withReceipt ? \"30\" : \"\";\r\n            default:\r\n                return \"\";\r\n        }\r\n    }\r\n    return \"\"\r\n}\r\n\r\n\r\n// Old Script\r\n// function cancelInvLines(){\r\n    \r\n//     line_arr = []\r\n//     header_rec = CralDB.QueryByComp(\"select * from {{einv_header}} where comp=$1 and tran='$2' and idoc=$3\",jscall.company,jscall.input.Company,jscall.input.TransactionType,jscall.input.InvoiceNumber)\r\n//     // return header_rec\r\n//     if (jscall.input.AllLines == true){\r\n       \r\n//         getAllLines = CralDB.QueryByComp(\"select * from {{einv_lines}} where comp=$1 and tran='$2' and idoc=$3\",jscall.company,jscall.input.Company,jscall.input.TransactionType,jscall.input.InvoiceNumber)\r\n        \r\n//         for (let i = 0; i \u003c getAllLines.length; i++){\r\n\r\n//             updateMultiRec = {\r\n//                 \"comp\":getAllLines[i].comp,\r\n//                 \"tran\":getAllLines[i].tran,\r\n//                 \"idoc\":getAllLines[i].idoc,\r\n//                 \"line\":getAllLines[i].line,\r\n//                 \"reason\":jscall.input.Lines[i].Reason\r\n//             }\r\n//            check = CralDB.PublishTopic(\"cancel_line\", jscall.company, \"Insert\", updateMultiRec, jscall.user)\r\n//             line_arr.push(updateMultiRec)\r\n\r\n//             statusUpdate = {\r\n//                 \"comp\":getAllLines[i].comp,\r\n//                 \"tran\":getAllLines[i].tran,\r\n//                 \"idoc\":getAllLines[i].idoc,\r\n//                 \"line\":getAllLines[i].line,\r\n//                 \"lsta\":'50',\r\n//                 \"cncl\":true\r\n//             }\r\n//             CralDB.PublishTopic(\"einv_lines\", jscall.company, \"Update\",statusUpdate, jscall.user)\r\n            \r\n//         }\r\n//     }else{\r\n//         // getline = CralDB.QueryByComp(\"select * from {{einv_lines}} where comp=$1 and tran='$2' and idoc=$3 and line=$4\",jscall.company,jscall.input.Company,jscall.input.TransactionType,jscall.input.InvoiceNumber,jscall.input.Lines[0].Line)\r\n//         // return getline\r\n//         for (let i = 0; i \u003c jscall.input.Lines.length; i++){\r\n\r\n//             updateSingleRec = {\r\n//                 \"comp\":jscall.input.Company,\r\n//                 \"tran\":jscall.input.TransactionType,\r\n//                 \"idoc\":jscall.input.InvoiceNumber,\r\n//                 \"line\":jscall.input.Lines[i].Line,\r\n//                 \"reason\":jscall.input.Lines[i].Reason,\r\n            \r\n//             }\r\n//           check =  CralDB.PublishTopic(\"cancel_line\", jscall.company, \"Insert\", updateSingleRec, jscall.user)\r\n        \r\n//          statusUpdate = {\r\n//             \"comp\":jscall.input.Company,\r\n//             \"tran\":jscall.input.TransactionType,\r\n//             \"idoc\":jscall.input.InvoiceNumber,\r\n//             \"line\":jscall.input.Lines[i].Line,\r\n//             \"lsta\":'50',\r\n//             \"cncl\":true\r\n//             }\r\n//             CralDB.PublishTopic(\"einv_lines\", jscall.company, \"Update\",statusUpdate, jscall.user)\r\n//         }\r\n//     }\r\n\r\n//     var currentDate = dateValidation() // *GetCurrentDateValidation\r\n\r\n//     updateObj = {\r\n//         \"comp\":header_rec[0].comp,\r\n//         \"tran\":header_rec[0].tran,\r\n//         \"idoc\":header_rec[0].idoc,\r\n//         \"doct\":header_rec[0].doct,\r\n//         \"reason\":jscall.input.Reason,\r\n//         \"cdte\":currentDate,\r\n//         // \"Lines\":line_arr\r\n//         \"scale\": (jscall.input.LNParameter.Scale == \"Up\") ? \"10\": \"20\",\r\n//         \"seri\": jscall.input.LNParameter.ManualId\r\n//     }\r\n//     check_h =CralDB.PublishTopic(\"cancel_header\", jscall.company, \"Insert\", updateObj, jscall.user)\r\n\r\n//     if (jscall.input.AllLines == true){\r\n//         statusUpdateHeadrer = {\r\n//                 \"comp\":header_rec[0].comp,\r\n//                 \"tran\":header_rec[0].tran,\r\n//                 \"idoc\":header_rec[0].idoc,\r\n//                 \"esta\":'50',\r\n//                 \"cncl\":true,\r\n//                 \"par_cncl\":false,\r\n//                 \"einv_stat\":\"50\"\r\n//             }\r\n//     }else{\r\n//         statusUpdateHeadrer = {\r\n//                 \"comp\":header_rec[0].comp,\r\n//                 \"tran\":header_rec[0].tran,\r\n//                 \"idoc\":header_rec[0].idoc,\r\n//                 \"esta\":'50',\r\n//                 \"cncl\":false,\r\n//                 \"par_cncl\":true,\r\n//                 \"einv_stat\":\"50\"\r\n//             }\r\n//     }\r\n//     ret2 = CralDB.PublishTopic(\"einv_header\", jscall.company, \"Update\",statusUpdateHeadrer, jscall.user)\r\n\r\n//     //countRec = CralDB.QueryByComp(\"select count(cncl) from {{einv_lines}} where comp=$1 and tran='$2' and idoc=$3 and line=$4 and cncl=$4\",jscall.company,jscall.input.Company,jscall.input.TransactionType,jscall.input.InvoiceNumber,jscall.input.Lines[0].Line,false)\r\n//     countRec = CralDB.QueryByComp(\"select count(cncl) from {{einv_lines}} where comp=$1 and tran='$2' and idoc=$3 and cncl=$4\",jscall.company,jscall.input.Company,jscall.input.TransactionType,jscall.input.InvoiceNumber,false)\r\n//     if (countRec[0].count == 0){\r\n//         changeStatusUpdate = {\r\n//             \"comp\":jscall.input.Company,\r\n//             \"tran\":jscall.input.TransactionType,\r\n//             \"idoc\":jscall.input.InvoiceNumber,\r\n//             \"cncl\":true,\r\n//             \"par_cncl\":false\r\n//             }\r\n//         ret1 = CralDB.PublishTopic(\"einv_header\", jscall.company, \"Update\",changeStatusUpdate, jscall.user)\r\n//     }\r\n//     seri = checkSeries(header_rec)\r\n//     resp = portaltoLN()\r\n//     return {\r\n//         \"Reasponce\":resp,\r\n//         \"seri\":seri \r\n//     }\r\n// }\r\n\r\n// function dateValidation(){\r\n\r\n//     var currentDate = new Date()\r\n    \r\n//     var year = currentDate.getFullYear(); // Full year (e.g., 2024)\r\n//     var month = currentDate.getMonth() +1 ; // Month (0-11, so add 1 for January to December)\r\n//     var day = currentDate.getDate(); // Day of the month (1-31)\r\n\r\n//     var hours = currentDate.getHours(); // Hours (0-23)\r\n//     var minutes = currentDate.getMinutes(); // Minutes (0-59)\r\n//     var seconds = currentDate.getSeconds(); // Seconds (0-59)\r\n\r\n//     return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}z`;\r\n// }\r\n\r\n// function portaltoLN(){\r\n//     results = []\r\n//     ret = []\r\n\r\n//     api_data = CralDB.QueryByComp(\"select * from {{e_inv_parameter}} where seqn=0\", 0)\r\n//     api_info = {\r\n//         \"url\":api_data[0].cws_url,\r\n//         \"userdetails\":{\r\n//             \"username\":api_data[0].cws_user,\r\n//             \"password\":api_data[0].cws_pswd\r\n//         }\r\n//     }\r\n//     token_info = jscall.ExecuteAPI(\"POST\", api_info.url + \"/auth\", api_info.userdetails)\r\n//     if (token_info.StatusCode != 200){\r\n\r\n//         return {\r\n//             \"Error\":\"Unable to Get Token\",\r\n//             \"Details\":token_info\r\n//         }\r\n        \r\n//     } else {\r\n//         response_data = JSON.parse(token_info.Data)\r\n//         if (response_data.Token !== \"\"){\r\n               \r\n//             payLoadLine = []\r\n\r\n//             for (let i = 0; i \u003c jscall.input.Lines.length; i++){\r\n               \r\n//                     payLoadObj = {\r\n//                         \"Line\":jscall.input.Lines[i].Line,\r\n//                         \"Reason\":jscall.input.Lines[i].Reason\r\n//                     }\r\n//                     payLoadLine.push(payLoadObj)\r\n//                 }\r\n//             lnPara = {}\r\n//             lnPara ={\r\n//                     \"Scale\":jscall.input.LNParameter.Scale,\r\n//                     \"ManualId\":jscall.input.LNParameter.ManualId \r\n//                     }\r\n\r\n//             payLoad = {\r\n//                      \"input.json\": {\r\n//                         \"AllLines\":jscall.input.AllLines,\r\n//                         \"Company\": jscall.input.Company,\r\n//                         \"InvoiceNumber\":jscall.input.InvoiceNumber,\r\n//                         \"TransactionType\":jscall.input.TransactionType,\r\n//                         \"Reason\":jscall.input.Reason,\r\n//                         \"LNParameter\":lnPara,\r\n//                         \"Lines\":payLoadLine\r\n//                         }\r\n//                     }\r\n        \r\n//             cancelInvoice = jscall.ExecuteAPI(\"POST\", api_info.url + \"/api/\" + jscall.company + \"/cancelinvoice\", payLoad, \"CWS-Token\", response_data.Token)\r\n           \r\n//             if (cancelInvoice.StatusCode == 200){\r\n//                 canl_inv_data = JSON.parse(cancelInvoice.Data)\r\n\r\n//                 canl_inv = canl_inv_data.GetDataResponse\r\n                    \r\n//                     cncl_Rec = CralDB.QueryByComp(\"select * from {{cancel_header}} where comp=$1 and tran='$2' and idoc=$3\",jscall.company,canl_inv.Company,canl_inv.TransactionType,canl_inv.InvoiceNumber)\r\n                   \r\n//                     // return canl_inv\r\n//                     if(cncl_Rec != 0){\r\n//                         manualId = {\r\n//                             \"comp\":canl_inv.Company,\r\n//                             \"tran\":canl_inv.TransactionType,\r\n//                             \"idoc\":canl_inv.InvoiceNumber,\r\n//                             \"adcn\":canl_inv.ManualSalesInv,\r\n//                             \"errm\":canl_inv.ErrorMessage\r\n//                         }\r\n//                         CralDB.PublishTopic(\"cancel_header\", jscall.company, \"Update\",manualId, jscall.user)\r\n//                         // return test\r\n                        \r\n                      \r\n//                         if (jscall.input.AllLines == true){\r\n        \r\n//                             for (let i = 0; i \u003c canl_inv.Lines.length; i++){\r\n                                \r\n//                                 updateManulLine = {\r\n//                                     \"comp\":canl_inv.Company,\r\n//                                     \"tran\":canl_inv.TransactionType,\r\n//                                     \"idoc\":canl_inv.InvoiceNumber,\r\n//                                     \"line\":canl_inv.Lines[i].Line,\r\n//                                     \"adcn\":canl_inv.Lines[i].ManualSalesLine,\r\n//                                     \"errm\":canl_inv.Lines[i].ErrorMessage\r\n                                   \r\n//                                 }\r\n//                                 // return updateManulLine\r\n//                                 CralDB.PublishTopic(\"cancel_line\", jscall.company, \"Update\", updateManulLine, jscall.user)\r\n                                \r\n//                                 getAllLinesLN = CralDB.QueryByComp(\"select * from {{cancel_lines}} where comp=$1 and tran='$2' and idoc=$3\",jscall.company,canl_inv.Company,canl_inv.TransactionType,canl_inv.InvoiceNumber)\r\n//                             }\r\n                            \r\n//                         }else{\r\n//                             for (let i = 0; i \u003c canl_inv.Lines.length; i++){\r\n\r\n//                                 updateManualLineSingle = {\r\n//                                     \"comp\":canl_inv.Company,\r\n//                                     \"tran\":canl_inv.TransactionType,\r\n//                                     \"idoc\":canl_inv.InvoiceNumber,\r\n//                                     \"line\":canl_inv.Lines[i].Line,\r\n//                                     \"adcn\":canl_inv.Lines[i].ManualSalesLine,\r\n//                                     \"errm\":canl_inv.Lines[i].ErrorMessage\r\n//                                 }\r\n                            \r\n//                                 CralDB.PublishTopic(\"cancel_line\", jscall.company, \"Update\", updateManualLineSingle, jscall.user)\r\n//                                 var err_msg = canl_inv.Line[i].ErrorMessage\r\n//                             }\r\n//                             // getAllLinesLN = CralDB.QueryByComp(\"select * from {{cancel_lines}} where comp=$1 and tran='$2' and idoc=$3 and line=$4\",jscall.company,canl_inv.Company,canl_inv.TransactionType,canl_inv.InvoiceNumber)\r\n                            \r\n                        \r\n//                         }\r\n//                         response = []\r\n\r\n//                         headerRes = {\r\n//                             \"HeaderErrorMessage\":canl_inv.ErrorMessage,\r\n//                             \"LineErrorMessage\":err_msg\r\n//                         }\r\n//                         response.push(headerRes)\r\n\r\n//                        return response\r\n\r\n//                     }else{\r\n                        \r\n//                         return{\r\n//                             \"InvoiceNumber\":canl_inv.InvoiceNumber,\r\n//                             \"Error\":\"Record not found\",\r\n//                             \"status\":cancelInvoice\r\n//                         }\r\n//                     }\r\n\r\n//             } else {\r\n                \r\n//                 return {\r\n//                     \"Error\":\"Unable to Get Responce\",\r\n//                     \"Details\": cancelInvoice,\r\n//                 }\r\n//             }\r\n//         } else {\r\n           \r\n//             return {\r\n//                 \"Error\":\"Unable to Get Token\"\r\n//             }\r\n//         }\r\n//     }\r\n// }\r\n// function checkSeries(header_rec){\r\n\r\n//     if (header_rec[0].src_type == '10'){\r\n//         data = CralDB.QueryByComp(\"select man_inv_ngrp from {{number_defaults }} where comp = $1\",jscall.company,header_rec[0].comp)\r\n//     }else if(header_rec[0].src_type == '20'){\r\n//         data = CralDB.QueryByComp(\"select man_soinv_ngrp  from {{number_defaults }} where comp = $1\",jscall.company,header_rec[0].comp)\r\n//     }else{\r\n//         jscall_error = \"Manual ID Not Found\";\r\n//         return false\r\n//     }\r\n\r\n//     get_seri = CralDB.QueryByComp(\"select * from {{number_grp}} where (ngrp='$1' or ngrp='$2') and seri='$3'\",jscall.company,data[0].man_inv_ngrp,data[0].man_soinv_ngrp,jscall.input.LNParameter.ManualId)\r\n    \r\n\r\n//     get_seri = CralDB.QueryByComp(\"select * from {{number_grp}} where (ngrp='$1' or ngrp='$2') and seri='$3'\",jscall.company,data[0].man_inv_ngrp,data[0].man_soinv_ngrp,jscall.input.LNParameter.ManualId)\r\n    \r\n//     bpActive = CralDB.QueryByComp(\"select buy_comp_active from {{buyer_companies}} where (buy_code = '$1' or buy_code = '$2')\",jscall.company,header_rec[0].itbp,header_rec[0].stbp)\r\n    \r\n//     if (bpActive[0].buy_comp_active != true){\r\n//         jscall_error = \"InActive BP\" \r\n//         return false\r\n//     }\r\n\r\n// }"},{"Bizobj":{"ObjectName":"print_options","Description":"Additional Print Options","external":true,"input_struct":"","out_success":"","out_fail":""},"Script":"//**** Business Object print_options Created by malai on 02-Jan-2025 05:15:56 ****//\r\n\r\nvar printPDF = require(\"./scripts/Business_Objects/printReport\")\r\n\r\nfunction getInvoicePDF(){\r\n    let results = []\r\n    if (Array.isArray(jscall.input.inv_numbers) \u0026\u0026 (jscall.input.inv_numbers.length)){\r\n        jscall.input.inv_numbers.forEach(inv =\u003e {\r\n            let result = {}\r\n            result[\"e_inv_no\"] = inv\r\n\r\n            inv_pdf_id = getInvoicePDF_ID(inv)\r\n            result[\"InvoicePDF\"] = inv_pdf_id\r\n\r\n            if (jscall.input.SendMail){\r\n                if (inv_pdf_id){\r\n                    mail_data_query = ` SELECT  doct, buy_email, sup_email,\r\n                                                buy_name, sup_name, etim, esta,\r\n                                                doc_uuid, submission_uid,\r\n                                                inv_pdf\r\n                                        FROM {{einv_header}} WHERE e_inv_no='${inv}'`\r\n                    result[\"mail\"] = sendInvoiceMail(inv, CralDB.QueryByComp(mail_data_query, jscall.company)[0])\r\n                    if (jscall.input.updateEinvoisStatus){\r\n                        // if (result.mail[\"Mail Status\"]?.Status){\r\n                            result[\"StatusUpdate\"] = CralDB.PublishTopic(\"einv_header\", jscall.company, \"Update\", {\r\n                                \"e_inv_no\": inv,\r\n                                \"einv_stat\": \"30\"\r\n                            }, jscall.user)\r\n\r\n                            CralUtil.LogInfo(\"Status Updation\", inv, result[\"StatusUpdate\"].Success)\r\n\r\n                            // if (!result[\"StatusUpdate\"]?.Success){\r\n                            //     CralUtil.LogInfo(\"ErrorUpdateStatus\", inv, result[\"StatusUpdate\"])\r\n                            // }\r\n                        // }\r\n                    }\r\n                } else {\r\n                    result[\"InvoiceMail\"] = \"Unable to Get Invoice PDF.\"\r\n                }\r\n            }\r\n            results.push(result)\r\n        })\r\n        return {\r\n            \"error\": \"\",\r\n            \"results\": results\r\n        }\r\n    } else {\r\n        return {\r\n            \"error\": \"Provide Invoice Numbers in array fromat. (inv_numbers)\",\r\n            \"results\": results\r\n        }\r\n    }\r\n}\r\n\r\nfunction getInvoicePDF_ID(e_inv_no){\r\n    let einv_pdf_data = CralDB.QueryByComp(`SELECT inv_pdf FROM {{einv_header}} WHERE e_inv_no='${e_inv_no}' AND esta='30'`, jscall.company)\r\n    if (einv_pdf_data?.length){\r\n        pdf_id = einv_pdf_data[0]?.inv_pdf??''\r\n        resourceDetails = Resources.GetResource(pdf_id)\r\n        if (resourceDetails?.ID){\r\n            return {\r\n                \"error\": \"\",\r\n                \"pdfID\": pdf_id\r\n            }\r\n        } else {\r\n            pdf = printPDF.printReportLayout(e_inv_no, \"\", \"\")\r\n            if (pdf?.result){\r\n                update_result = CralDB.PublishTopic(\"einv_header\", jscall.company, \"Update\", {\"e_inv_no\": e_inv_no, \"inv_pdf\": pdf.result }, jscall.user)\r\n                if (!update_result?.Success){\r\n                    CralUtil.LogInfo(\"PDFUpdation\", e_inv_no, update_result)\r\n                }\r\n                return {\r\n                    \"error\": \"\",\r\n                    \"pdfID\": pdf.result\r\n                }\r\n            } else {\r\n                return {\r\n                    \"error\": \"Unable to Generate New Report \" + pdf?.error??'',\r\n                    \"pdfID\": pdf.result\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        return {\r\n            \"error\": \"Unable to Find Invoice\",\r\n            \"pdfID\": \"\"\r\n        }\r\n    }\r\n}\r\n\r\n// function sendInvoiceMail(einv_number, lhdn_status, validated_time, mail_data){\r\nfunction sendInvoiceMail(einv_number, mail_data){\r\n    debug(\"Sending Mail\")\r\n    mail = {}\r\n    mail.To = []\r\n    mail.Cc = []\r\n    self_inv = false\r\n    if (mail_data?.doct == \"11\" || mail_data?.doct == \"12\" || mail_data?.doct == \"13\" || mail_data?.doct == \"14\"){\r\n        self_inv = true\r\n        cc_mail = mail_data.buy_email\r\n        to_mail = mail_data.sup_email\r\n        supplier_name = mail_data.buy_name\r\n        buyer_name = mail_data.sup_name\r\n    } else {\r\n        to_mail = mail_data.buy_email\r\n        cc_mail = mail_data.sup_email\r\n        buyer_name = mail_data.buy_name\r\n        supplier_name = mail_data.sup_name\r\n    }\r\n    if (cc_mail != \"\" \u0026\u0026 cc_mail != null \u0026\u0026 cc_mail != undefined){\r\n        mail.Cc.push(cc_mail)\r\n    }\r\n    if (to_mail != \"\" \u0026\u0026 to_mail != null \u0026\u0026 to_mail != undefined){\r\n        mail.To.push(to_mail)\r\n    }\r\n    mail.Subject = supplier_name.split(\" \")[0] + \"_Invoice Validation_\" + einv_number\r\n    mail.Template = \"docStatus\"\r\n    \r\n    mail.InputObject = {\r\n        \"buyer\": buyer_name,\r\n        \"invoice\": einv_number,\r\n        // \"vld_time\": mail_data.etim,\r\n        \"vld_time\": new Date(mail_data.etim.toString().slice(0,21).replace(' ', 'T').replace(' +', 'Z')).toLocaleString().replace(\",\", \"\").replaceAll(\"/\", \"-\").replace(/(\\d{2})-(\\d{2})-(\\d{4})/, \"$2-$1-$3\"),\r\n        \"status\": CralUtil.GetListDesc(\"lhdn_status\", mail_data.esta),\r\n        \"uuid\": mail_data?.doc_uuid,\r\n        \"submit_id\": mail_data?.submission_uid,\r\n    }\r\n    if (mail_data.inv_pdf != \"\" \u0026\u0026 mail_data.inv_pdf != null \u0026\u0026 mail_data.inv_pdf != undefined){\r\n        mail.FileAttachments = [mail_data.inv_pdf]\r\n    }\r\n    CralUtil.LogInfo(\"Mail Data\", einv_number, mail)\r\n    mail_ret = CralUtil.SendMail(mail)\r\n    CralUtil.LogInfo(\"Mail Status\", einv_number, mail_ret)\r\n    \r\n    return {\"Invoice No\": einv_number, \"Mail Status\":mail_ret, \"Date \u0026 Time\":new Date()}\r\n}\r\n\r\n"}],"Roles":null,"DataSets":[{"Dataset":{"Id":"invoice_data","Description":"E-Invoice Data - MELM","Query":"WITH Headertext AS (\r\n    SELECT \r\n        CASE \r\n            WHEN reference1 IS NULL THEN '' \r\n            ELSE reference1 \r\n        END AS reference1\r\n    FROM {{einv_lines}}\r\n    WHERE e_inv_no = '$1' AND (reference1 != '' OR reference1 IS NULL) ORDER BY line LIMIT 1\r\n),\r\nAddHeaderTxt AS (\r\n    SELECT \r\n        CASE \r\n            WHEN reference2 IS NULL THEN '' \r\n            ELSE reference2 \r\n        END AS reference2\r\n    FROM {{einv_lines}}\r\n    WHERE e_inv_no = '$1' AND (reference2 != '' OR reference2 IS NULL) ORDER BY line LIMIT 1\r\n),\r\nLineTxt AS (\r\n    SELECT \r\n        CASE \r\n            WHEN reference3 IS NULL THEN '' \r\n            ELSE reference3 \r\n        END AS reference3\r\n    FROM {{einv_lines}}\r\n    WHERE e_inv_no = '$1' AND (reference3 != '' OR reference3 IS NULL) ORDER BY line LIMIT 1\r\n),\r\nDetailTxt AS (\r\n    SELECT \r\n        CASE \r\n            WHEN reference4 IS NULL THEN '' \r\n            ELSE reference4 \r\n        END AS reference4\r\n    FROM {{einv_lines}}\r\n    WHERE e_inv_no = '$1' AND (reference4 != '' OR reference4 IS NULL) ORDER BY line LIMIT 1\r\n),\r\nCombinedText AS (\r\n    SELECT \r\n        t.invoiceText,\r\n        t.index_txt\r\n    FROM \r\n        (SELECT\r\n            CONCAT(\r\n                Headertext.reference1,\r\n                CASE WHEN Headertext.reference1 = '' THEN '' ELSE '|'  END,\r\n                AddHeaderTxt.reference2, \r\n                CASE WHEN AddHeaderTxt.reference2 = '' THEN '' ELSE '|' END, \r\n                LineTxt.reference3, \r\n                CASE WHEN LineTxt.reference3 = '' THEN '' ELSE '|' END, \r\n                DetailTxt.reference4\r\n            ) AS invoiceText,\r\n            ROW_NUMBER() OVER (ORDER BY unnest(string_to_array(CONCAT(\r\n                Headertext.reference1,\r\n                CASE WHEN Headertext.reference1 = '' THEN '' ELSE '|' END,\r\n                AddHeaderTxt.reference2, \r\n                CASE WHEN AddHeaderTxt.reference2 = '' THEN '' ELSE '|' END, \r\n                LineTxt.reference3, \r\n                CASE WHEN LineTxt.reference3 = '' THEN '' ELSE '|' END, \r\n                DetailTxt.reference4\r\n            ), '|'))) AS index_txt\r\n        FROM \r\n            Headertext\r\n        FULL OUTER JOIN AddHeaderTxt ON true\r\n        FULL OUTER JOIN LineTxt ON true\r\n        FULL OUTER JOIN DetailTxt ON true) t\r\n)\r\n\r\nSELECT hdr.* ,\r\n        ct.index_txt  as index_txt,\r\n        lines.line,\r\n        lines.cuni,\r\n        lines.ccty,\r\n        lines.clas,\r\n        lines.item,\r\n        lines.item_desc,\r\n        lines.pric,\r\n        lines.pvat,\r\n        lines.txai,\r\n        lines.ceno,\r\n        lines.amtt,\r\n        lines.stot,\r\n        lines.amti,\r\n        lines.dqua,\r\n        lines.disc,\r\n        lines.ldai,\r\n        lines.ccde,\r\n        lines.feer,\r\n        lines.feea,\r\n        lines.disc_reason,\r\n        lines.fee_reason,\r\n        lines.cvat           as  l_cvat,\r\n        lines.reference0     as  l_reference0,\r\n        lines.reference1     as  l_reference1,\r\n        lines.reference2     as  l_reference2,\r\n        lines.reference3     as  l_reference3,\r\n        lines.reference4     as  l_reference4,\r\n        lines.reference5     as  l_reference5,\r\n        lines.reference6     as  l_reference6,\r\n        lines.reference7     as  l_reference7,\r\n        lines.reference8     as  l_reference8,\r\n        lines.reference9     as  l_reference9,\r\n        lines.reference10    as  l_reference10,\r\n        lines.reference11    as  l_reference11,\r\n        lines.reference12    as  l_reference12,\r\n        lines.reference13    as  l_reference13,\r\n        lines.reference14    as  l_reference14,\r\n        lines.reference15    as  l_reference15,\r\n        lines.reference16    as  l_reference16,\r\n        lines.reference17    as  l_reference17,\r\n        lines.reference18    as  l_reference18,\r\n        lines.reference19    as  l_reference19,\r\n        lines.reference20    as  l_reference20,\r\n        eds.skip_master,\r\n        etype.dsca          as doc_dsca,\r\n        CASE \r\n            WHEN hdr.doct IN ('01', '02', '03', '04') THEN hdr.sup_name\r\n            ELSE hdr.buy_name\r\n        END AS comp_name,\r\n        CASE \r\n            WHEN hdr.doct IN ('01', '02', '03', '04') THEN hdr.sup_email\r\n            ELSE hdr.buy_email\r\n        END AS comp_mail,\r\n        CASE \r\n            WHEN hdr.doct IN ('01', '02', '03', '04') THEN hdr.sup_cont_num\r\n            ELSE hdr.buy_cont_num\r\n        END AS comp_cont_num,\r\n        CASE \r\n            WHEN hdr.doct IN ('01', '02', '03', '04') THEN hdr.sup_reg_brn\r\n            ELSE hdr.buy_reg_brn\r\n        END AS comp_brn,\r\n        CASE \r\n            WHEN hdr.doct IN ('01', '02', '03', '04') THEN hdr.sup_tin\r\n            ELSE hdr.buy_tin\r\n        END AS comp_tin,\r\n        CASE \r\n            WHEN hdr.doct IN ('01', '02', '03', '04') THEN hdr.sup_sst_reg\r\n            ELSE hdr.buy_sst_reg\r\n        END AS comp_sst,\r\n        CASE \r\n            WHEN hdr.doct IN ('01', '02', '03', '04') THEN hdr.sup_msic\r\n            ELSE sup.sup_msic\r\n        END AS comp_msic,\r\n        CASE \r\n            WHEN hdr.doct IN ('01', '02', '03', '04') THEN hdr.sup_badsca\r\n            ELSE sup.sup_badsca\r\n        END AS comp_badsca,\r\n        CONCAT_WS(', ', \r\n            NULLIF(hdr.sup_adrs_line0, ''), \r\n            NULLIF(hdr.sup_adrs_line1, ''), \r\n            NULLIF(hdr.sup_adrs_line2, '')\r\n        ) AS supplier_address_line,\r\n        CONCAT_WS(', ', \r\n            NULLIF(hdr.sup_postal_zone, ''),\r\n            NULLIF(hdr.sup_city, ''),\r\n            NULLIF(scste.dsca , ''),\r\n            NULLIF(sccty.dsca, '')\r\n        ) AS supplier_address,\r\n        CONCAT_WS(', ', \r\n            NULLIF(hdr.buy_adrs_line0, ''), \r\n            NULLIF(hdr.buy_adrs_line1, ''), \r\n            NULLIF(hdr.buy_adrs_line2, '')\r\n        ) AS buyer_address_line,\r\n        CONCAT_WS(', ',\r\n            NULLIF(hdr.buy_postal_zone, ''),\r\n            NULLIF(hdr.buy_city, ''),\r\n            NULLIF(bcste.dsca , ''),\r\n            NULLIF(bccty.dsca, '')\r\n        ) AS buyer_address,\r\n        CASE \r\n            WHEN hdr.doct IN ('01', '02', '03', '04') THEN CONCAT_WS(', ', \r\n            NULLIF(hdr.sup_adrs_line0, ''), \r\n            NULLIF(hdr.sup_adrs_line1, ''), \r\n            NULLIF(hdr.sup_adrs_line2, '')\r\n        )\r\n            ELSE CONCAT_WS(', ', \r\n            NULLIF(hdr.buy_adrs_line0, ''), \r\n            NULLIF(hdr.buy_adrs_line1, ''), \r\n            NULLIF(hdr.buy_adrs_line2, '')\r\n        )\r\n        END AS comp_address_line,\r\n        CASE \r\n            WHEN hdr.doct IN ('01', '02', '03', '04') THEN CONCAT_WS(', ',\r\n            NULLIF(hdr.sup_postal_zone, ''),\r\n            NULLIF(hdr.sup_city, ''),\r\n            NULLIF(scste.dsca , ''),\r\n            NULLIF(sccty.dsca, '')\r\n        )\r\n            ELSE CONCAT_WS(', ', \r\n            NULLIF(hdr.buy_postal_zone, ''),\r\n            NULLIF(hdr.buy_city, ''),\r\n            NULLIF(bcste.dsca , ''),\r\n            NULLIF(bccty.dsca, '')\r\n        )\r\n        END AS comp_address,\r\n        scste.dsca          as sup_cste_dsca,\r\n        sccty.dsca          as sup_ccty_dsca,\r\n        bcste.dsca          as buy_cste_dsca,\r\n        bccty.dsca          as buy_ccty_dsca,\r\n        lines.cvat          as tax_type,\r\n        param.lhdn_portal    as qr_url,\r\n        -- sup_rbm.sup_reg_brn as rbm_brn,\r\n        -- sup_rbm.sup_tin     as rbm_tin,\r\n        -- sup_rbm.sup_sst_reg as rbm_sst,\r\n        -- sup_rbm.sup_msic    as rbm_msic,\r\n        -- CONCAT_WS(', ', \r\n        --     NULLIF(rbm_adrs.adrs_line0, ''), \r\n        --     NULLIF(rbm_adrs.adrs_line1, ''), \r\n        --     NULLIF(rbm_adrs.adrs_line2, '')\r\n        -- ) AS rbm_address_line,\r\n        -- CONCAT_WS(', ',\r\n        --     NULLIF(rbm_adrs.postal_zone, ''),\r\n        --     NULLIF(rbm_adrs.adrs_city, ''),\r\n        --     NULLIF(rbm_state.dsca , ''),\r\n        --     NULLIF(rbm_ccty.dsca, '')\r\n        -- ) AS rbm_address,\r\n        ct.invoiceText AS invtxt\r\nFROM  {{einv_header}} as hdr LEFT OUTER JOIN  {{einv_lines}} as lines ON hdr.e_inv_no = lines.e_inv_no\r\nLEFT JOIN CombinedText AS ct ON lines.line = (SELECT MAX(line) AS max_line\r\n    FROM {{einv_lines}}\r\n    WHERE e_inv_no = '$1')\r\nLEFT OUTER JOIN {{supplier_companies}} as sup ON hdr.comp = sup.sup_company\r\nLEFT OUTER JOIN {{address_master}} as cadr ON sup.sup_adrs = cadr.adrs_code and hdr.dataset = cadr.data_set\r\nLEFT OUTER JOIN {{entity_data_set}} as eds ON hdr.comp = eds.sup_company and hdr.dataset = eds.data_set\r\n\r\nLEFT OUTER JOIN {{state_codes}} as cstate ON cadr.adrs_state=cstate.code and eds.skip_master=true\r\nLEFT OUTER JOIN {{country}} as ccountry ON cadr.adrs_country=ccountry.ccty and eds.skip_master=true\r\n\r\n-- LEFT OUTER JOIN {{supplier_companies}} as sup_rbm ON sup_rbm.sup_company=889\r\n-- LEFT OUTER JOIN address_master_0889 as rbm_adrs ON sup_rbm.sup_adrs = rbm_adrs.adrs_code and hdr.dataset = rbm_adrs.data_set\r\n-- LEFT OUTER JOIN {{map_state_codes}} as rbm_state ON rbm_adrs.adrs_state=rbm_state.src_cste and rbm_adrs.adrs_country=rbm_state.src_ccty and hdr.dataset = rbm_adrs.data_set and eds.skip_master=false\r\n-- LEFT OUTER JOIN {{country_codes}} as rbm_ccty ON rbm_adrs.adrs_country=rbm_ccty.src_ccty and hdr.dataset = rbm_ccty.data_set and eds.skip_master=false\r\n\r\nLEFT OUTER JOIN {{map_state_codes}} as ccste ON cadr.adrs_state=ccste.src_cste and cadr.adrs_country=ccste.src_ccty and hdr.dataset = ccste.data_set and eds.skip_master=false\r\nLEFT OUTER JOIN {{country_codes}} as cccty ON cadr.adrs_country=cccty.src_ccty and hdr.dataset = cccty.data_set and eds.skip_master=false\r\n\r\nLEFT OUTER JOIN {{einv_doc_types}} as etype ON hdr.doct=etype.code\r\nLEFT OUTER JOIN {{state_codes}} as scste ON hdr.sup_cste=scste.code \r\nLEFT OUTER JOIN {{country}} as sccty ON hdr.sup_country=sccty.ccty\r\nLEFT OUTER JOIN {{state_codes}} as bcste ON hdr.buy_cste=bcste.code\r\nLEFT OUTER JOIN {{country}} as bccty ON hdr.buy_country=bccty.ccty,\r\n\r\n{{e_inv_parameter}} as param\r\nWHERE  hdr.e_inv_no = '$1'\r\norder by lines.line"}}],"Screens":null,"EmailTemplates":null,"Lists":null,"Reports":null}